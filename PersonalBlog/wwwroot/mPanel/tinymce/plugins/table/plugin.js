!function(){"use strict";var n=function(){},t=function(n){return function(){return n}},e=function(n){return n};function r(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o=t.concat(e);return n.apply(null,o)}}var o,u,i,c=function(n){return function(t){return!n(t)}},a=t(!1),l=t(!0),f=function(){return s},s=(o=function(n){return n.isNone()},{fold:function(n,t){return n()},is:a,isSome:a,isNone:l,getOr:i=function(n){return n},getOrThunk:u=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:t(null),getOrUndefined:t(void 0),or:i,orThunk:u,map:f,each:n,bind:f,exists:a,forall:l,filter:f,equals:o,equals_:o,toArray:function(){return[]},toString:t("none()")}),d=function(n){var e=t(n),r=function(){return u},o=function(t){return t(n)},u={fold:function(t,e){return e(n)},is:function(t){return n===t},isSome:l,isNone:a,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:r,orThunk:r,map:function(t){return d(t(n))},each:function(t){t(n)},bind:o,exists:o,forall:o,filter:function(t){return t(n)?u:s},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(t){return t.is(n)},equals_:function(t,e){return t.fold(a,(function(t){return e(n,t)}))}};return u},m={some:d,none:f,from:function(n){return null==n?s:d(n)}},p=function(n){return function(t){return r=typeof(e=t),(null===e?"null":"object"===r&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"===r&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":r)===n;var e,r}},g=function(n){return function(t){return typeof t===n}},v=p("string"),h=p("object"),b=p("array"),w=g("boolean"),y=(void 0,function(n){return undefined===n}),x=function(n){return!function(n){return null==n}(n)},C=g("function"),S=g("number"),T=Array.prototype.slice,R=Array.prototype.indexOf,O=Array.prototype.push,D=function(n,t){return function(n,t){return R.call(n,t)}(n,t)>-1},A=function(n,t){for(var e=0,r=n.length;e<r;e++)if(t(n[e],e))return!0;return!1},B=function(n,t){for(var e=[],r=0;r<n;r++)e.push(t(r));return e},E=function(n,t){for(var e=n.length,r=new Array(e),o=0;o<e;o++){var u=n[o];r[o]=t(u,o)}return r},P=function(n,t){for(var e=0,r=n.length;e<r;e++)t(n[e],e)},I=function(n,t){for(var e=[],r=0,o=n.length;r<o;r++){var u=n[r];t(u,r)&&e.push(u)}return e},M=function(n,t,e){return function(n,t){for(var e=n.length-1;e>=0;e--)t(n[e])}(n,(function(n){e=t(e,n)})),e},k=function(n,t,e){return P(n,(function(n){e=t(e,n)})),e},N=function(n,t){return function(n,t,e){for(var r=0,o=n.length;r<o;r++){var u=n[r];if(t(u,r))return m.some(u);if(e(u,r))break}return m.none()}(n,t,a)},_=function(n,t){for(var e=0,r=n.length;e<r;e++)if(t(n[e],e))return m.some(e);return m.none()},z=function(n){for(var t=[],e=0,r=n.length;e<r;++e){if(!b(n[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+n);O.apply(t,n[e])}return t},W=function(n,t){return z(E(n,t))},j=function(n,t){for(var e=0,r=n.length;e<r;++e)if(!0!==t(n[e],e))return!1;return!0},F=function(n){return[n]},L=function(n,t){return t>=0&&t<n.length?m.some(n[t]):m.none()},H=function(n){return L(n,n.length-1)},q=function(n,t){for(var e=0;e<n.length;e++){var r=t(n[e],e);if(r.isSome())return r}return m.none()},V=function(){return(V=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n}).apply(this,arguments)};function U(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;var r=Array(n),o=0;for(t=0;t<e;t++)for(var u=arguments[t],i=0,c=u.length;i<c;i++,o++)r[o]=u[i];return r}var $=function(n){var t,e=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return e||(e=!0,t=n.apply(null,r)),t}},G=function(){return K(0,0)},K=function(n,t){return{major:n,minor:t}},X=function(n,t){var e=String(t).toLowerCase();return 0===n.length?G():function(n,t){var e=function(n,t){for(var e=0;e<n.length;e++){var r=n[e];if(r.test(t))return r}}(n,t);if(!e)return{major:0,minor:0};var r=function(n){return Number(t.replace(e,"$"+n))};return K(r(1),r(2))}(n,e)},Y=G,J=function(n,t){var e=String(t).toLowerCase();return N(n,(function(n){return n.search(e)}))},Q=function(n,t,e){return""===t||n.length>=t.length&&n.substr(e,e+t.length)===t},Z=function(n,t){return-1!==n.indexOf(t)},nn=function(n,t){return Q(n,t,0)},tn=function(n,t){return Q(n,t,n.length-t.length)},en=function(n){return function(t){return t.replace(n,"")}}(/^\s+|\s+$/g),rn=function(n){return n.length>0},on=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,un=function(n){return function(t){return Z(t,n)}},cn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return Z(n,"edge/")&&Z(n,"chrome")&&Z(n,"safari")&&Z(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,on],search:function(n){return Z(n,"chrome")&&!Z(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return Z(n,"msie")||Z(n,"trident")}},{name:"Opera",versionRegexes:[on,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:un("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:un("firefox")},{name:"Safari",versionRegexes:[on,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(Z(n,"safari")||Z(n,"mobile/"))&&Z(n,"applewebkit")}}],an=[{name:"Windows",search:un("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return Z(n,"iphone")||Z(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:un("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:un("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:un("linux"),versionRegexes:[]},{name:"Solaris",search:un("sunos"),versionRegexes:[]},{name:"FreeBSD",search:un("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:un("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],ln={browsers:t(cn),oses:t(an)},fn="Edge",sn="Chrome",dn="Opera",mn="Firefox",pn="Safari",gn=function(n){var t=n.current,e=n.version,r=function(n){return function(){return t===n}};return{current:t,version:e,isEdge:r(fn),isChrome:r(sn),isIE:r("IE"),isOpera:r(dn),isFirefox:r(mn),isSafari:r(pn)}},vn=function(){return gn({current:void 0,version:Y()})},hn=gn,bn=(t(fn),t(sn),t("IE"),t(dn),t(mn),t(pn),"Windows"),wn="Android",yn="Linux",xn="Solaris",Cn="FreeBSD",Sn="ChromeOS",Tn=function(n){var t=n.current,e=n.version,r=function(n){return function(){return t===n}};return{current:t,version:e,isWindows:r(bn),isiOS:r("iOS"),isAndroid:r(wn),isOSX:r("OSX"),isLinux:r(yn),isSolaris:r(xn),isFreeBSD:r(Cn),isChromeOS:r(Sn)}},Rn=function(){return Tn({current:void 0,version:Y()})},On=Tn,Dn=(t(bn),t("iOS"),t(wn),t(yn),t("OSX"),t(xn),t(Cn),t(Sn),function(n,e){var r=ln.browsers(),o=ln.oses(),u=function(n,t){return J(n,t).map((function(n){var e=X(n.versionRegexes,t);return{current:n.name,version:e}}))}(r,n).fold(vn,hn),i=function(n,t){return J(n,t).map((function(n){var e=X(n.versionRegexes,t);return{current:n.name,version:e}}))}(o,n).fold(Rn,On),c=function(n,e,r,o){var u=n.isiOS()&&!0===/ipad/i.test(r),i=n.isiOS()&&!u,c=n.isiOS()||n.isAndroid(),a=c||o("(pointer:coarse)"),l=u||!i&&c&&o("(min-device-width:768px)"),f=i||c&&!l,s=e.isSafari()&&n.isiOS()&&!1===/safari/i.test(r),d=!f&&!l&&!s;return{isiPad:t(u),isiPhone:t(i),isTablet:t(l),isPhone:t(f),isTouch:t(a),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:t(s),isDesktop:t(d)}}(i,u,n,e);return{browser:u,os:i,deviceType:c}}),An=function(n){return window.matchMedia(n).matches},Bn=$((function(){return Dn(navigator.userAgent,An)})),En=function(){return Bn()},Pn=function(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:n}},In={fromHtml:function(n,t){var e=(t||document).createElement("div");if(e.innerHTML=n,!e.hasChildNodes()||e.childNodes.length>1)throw console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return Pn(e.childNodes[0])},fromTag:function(n,t){var e=(t||document).createElement(n);return Pn(e)},fromText:function(n,t){var e=(t||document).createTextNode(n);return Pn(e)},fromDom:Pn,fromPoint:function(n,t,e){return m.from(n.dom.elementFromPoint(t,e)).map(Pn)}},Mn=function(n,t){var e=n.dom;if(1!==e.nodeType)return!1;var r=e;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},kn=function(n){return 1!==n.nodeType&&9!==n.nodeType&&11!==n.nodeType||0===n.childElementCount},Nn=function(n,t){return n.dom===t.dom},_n=function(n,t){return En().browser.isIE()?function(n,t){return e=n.dom,r=t.dom,o=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(e.compareDocumentPosition(r)&o);var e,r,o}(n,t):function(n,t){var e=n.dom,r=t.dom;return e!==r&&e.contains(r)}(n,t)},zn=Mn,Wn=Object.keys,jn=Object.hasOwnProperty,Fn=function(n,t){for(var e=Wn(n),r=0,o=e.length;r<o;r++){var u=e[r];t(n[u],u)}},Ln=function(n,t){return Hn(n,(function(n,e){return{k:e,v:t(n,e)}}))},Hn=function(n,t){var e={};return Fn(n,(function(n,r){var o=t(n,r);e[o.k]=o.v})),e},qn=function(t,e){var r={};return function(n,t,e,r){Fn(n,(function(n,o){(t(n,o)?e:r)(n,o)}))}(t,e,function(n){return function(t,e){n[e]=t}}(r),n),r},Vn=function(n,t){return Un(n,t)?m.from(n[t]):m.none()},Un=function(n,t){return jn.call(n,t)},$n=["tfoot","thead","tbody","colgroup"],Gn=function(n,t,e){return{element:n,rowspan:t,colspan:e}},Kn=function(n,t,e){return{element:n,cells:t,section:e}},Xn=function(n,t){return{element:n,isNew:t}},Yn=function(n,t){return{cells:n,section:t}},Jn=("undefined"!=typeof window?window:Function("return this;")(),function(n){return n.dom.nodeName.toLowerCase()}),Qn=function(n){return n.dom.nodeType},Zn=function(n){return function(t){return Qn(t)===n}},nt=function(n){return 8===Qn(n)||"#comment"===Jn(n)},tt=Zn(1),et=Zn(3),rt=Zn(9),ot=Zn(11),ut=function(n){return In.fromDom(n.dom.ownerDocument)},it=function(n){return rt(n)?n:ut(n)},ct=function(n){return m.from(n.dom.parentNode).map(In.fromDom)},at=function(n,t){for(var e=C(t)?t:a,r=n.dom,o=[];null!==r.parentNode&&void 0!==r.parentNode;){var u=r.parentNode,i=In.fromDom(u);if(o.push(i),!0===e(i))break;r=u}return o},lt=function(n){return m.from(n.dom.previousSibling).map(In.fromDom)},ft=function(n){return m.from(n.dom.nextSibling).map(In.fromDom)},st=function(n){return E(n.dom.childNodes,In.fromDom)},dt=function(n,t){var e=n.dom.childNodes;return m.from(e[t]).map(In.fromDom)},mt=C(Element.prototype.attachShadow)&&C(Node.prototype.getRootNode),pt=t(mt),gt=mt?function(n){return In.fromDom(n.dom.getRootNode())}:it,vt=function(n){return In.fromDom(n.dom.host)},ht=function(n){return x(n.dom.shadowRoot)},bt=function(n){var t=et(n)?n.dom.parentNode:n.dom;if(null==t||null===t.ownerDocument)return!1;var e,r,o=t.ownerDocument;return function(n){var t=gt(n);return ot(t)?m.some(t):m.none()}(In.fromDom(t)).fold((function(){return o.body.contains(t)}),(e=bt,r=vt,function(n){return e(r(n))}))},wt=function(n){var t=n.dom.body;if(null==t)throw new Error("Body is not available yet");return In.fromDom(t)},yt=function(n,t){var e=[];return P(st(n),(function(n){t(n)&&(e=e.concat([n])),e=e.concat(yt(n,t))})),e},xt=function(n,t,e){return function(n,e,r){return I(at(n,r),(function(n){return Mn(n,t)}))}(n,0,e)},Ct=function(n,t){return function(n,e){return I(st(n),(function(n){return Mn(n,t)}))}(n)},St=function(n,t){return function(n,t){var e=void 0===t?document:t.dom;return kn(e)?[]:E(e.querySelectorAll(n),In.fromDom)}(t,n)};function Tt(n,t,e,r,o){return n(e,r)?m.some(e):C(o)&&o(e)?m.none():t(e,r,o)}var Rt=function(n,t,e){for(var r=n.dom,o=C(e)?e:a;r.parentNode;){r=r.parentNode;var u=In.fromDom(r);if(t(u))return m.some(u);if(o(u))break}return m.none()},Ot=function(n,t,e){return Rt(n,(function(n){return Mn(n,t)}),e)},Dt=function(n,t){return function(n,e){return N(n.dom.childNodes,(function(n){return e=In.fromDom(n),Mn(e,t);var e})).map(In.fromDom)}(n)},At=function(n,t){return function(n,t){var e=void 0===t?document:t.dom;return kn(e)?m.none():m.from(e.querySelector(n)).map(In.fromDom)}(t,n)},Bt=function(n,t,e){return Tt((function(n,t){return Mn(n,t)}),Ot,n,t,e)},Et=function(n,t,e){if(!(v(e)||w(e)||S(e)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",e,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(t,e+"")},Pt=function(n,t,e){Et(n.dom,t,e)},It=function(n,t){var e=n.dom;Fn(t,(function(n,t){Et(e,t,n)}))},Mt=function(n,t){var e=n.dom.getAttribute(t);return null===e?void 0:e},kt=function(n,t){return m.from(Mt(n,t))},Nt=function(n,t){n.dom.removeAttribute(t)},_t=function(n){return k(n.dom.attributes,(function(n,t){return n[t.name]=t.value,n}),{})},zt=function(n){return void 0!==n.style&&C(n.style.getPropertyValue)},Wt=function(n,t,e){if(!v(e))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",e,":: Element ",n),new Error("CSS value must be a string: "+e);zt(n)&&n.style.setProperty(t,e)},jt=function(n,t,e){var r=n.dom;Wt(r,t,e)},Ft=function(n,t){var e=n.dom;Fn(t,(function(n,t){Wt(e,t,n)}))},Lt=function(n,t){var e=n.dom,r=window.getComputedStyle(e).getPropertyValue(t);return""!==r||bt(n)?r:Ht(e,t)},Ht=function(n,t){return zt(n)?n.style.getPropertyValue(t):""},qt=function(n,t){var e=n.dom,r=Ht(e,t);return m.from(r).filter((function(n){return n.length>0}))},Vt=function(n,t){!function(n,t){zt(n)&&n.style.removeProperty(t)}(n.dom,t),kt(n,"style").map(en).is("")&&Nt(n,"style")},Ut=function(n,t,e){return void 0===e&&(e=0),kt(n,t).map((function(n){return parseInt(n,10)})).getOr(e)},$t=function(n,t){return Ut(n,t,1)},Gt=function(n){return $t(n,"colspan")>1},Kt=function(n){return $t(n,"rowspan")>1},Xt=function(n,t){return parseInt(Lt(n,t),10)},Yt=t(10),Jt=t(10),Qt=function(n,t){return Zt(n,t,l)},Zt=function(n,t,e){return W(st(n),(function(n){return Mn(n,t)?e(n)?[n]:[]:Zt(n,t,e)}))},ne=function(n,t){return function(n,t,e){return void 0===e&&(e=a),e(t)?m.none():D(n,Jn(t))?m.some(t):Ot(t,n.join(","),(function(n){return Mn(n,"table")||e(n)}))}(["td","th"],n,t)},te=function(n){return Qt(n,"th,td")},ee=function(n){return Mn(n,"colgroup")?Ct(n,"col"):W(ue(n),(function(n){return Ct(n,"col")}))},re=function(n,t){return Bt(n,"table",t)},oe=function(n){return Qt(n,"tr")},ue=function(n){return re(n).fold(t([]),(function(n){return Ct(n,"colgroup")}))},ie=function(n,t){return E(n,(function(n){if("colgroup"===Jn(n)){var e=E(ee(n),(function(n){var t=Ut(n,"span",1);return Gn(n,1,t)}));return Kn(n,e,"colgroup")}return e=E(te(n),(function(n){var t=Ut(n,"rowspan",1),e=Ut(n,"colspan",1);return Gn(n,t,e)})),Kn(n,e,t(n))}))},ce=function(n){return ct(n).map((function(n){var t=Jn(n);return function(n){return D($n,n)}(t)?t:"tbody"})).getOr("tbody")},ae=function(n){var t=oe(n),e=U(ue(n),t);return ie(e,ce)},le=function(n,t){return n+","+t},fe=function(n,t){var e=W(n.all,(function(n){return n.cells}));return I(e,t)},se=function(n){var t={},e=[],r={},o=0,u=0,i=0;return P(n,(function(n){if("colgroup"===n.section)r=function(n){var t={},e=0;return P(n.cells,(function(n){var r=n.colspan;B(r,(function(o){var u=e+o;t[u]=function(n,t,e){return{element:n,colspan:t,column:e}}(n.element,r,u)})),e+=r})),t}(n);else{var c=[];P(n.cells,(function(n){for(var e=0;void 0!==t[le(i,e)];)e++;for(var r=(s=n.element,d=n.rowspan,m=n.colspan,{element:s,rowspan:d,colspan:m,row:i,column:e}),o=0;o<n.colspan;o++)for(var a=0;a<n.rowspan;a++){var l=e+o,f=le(i+a,l);t[f]=r,u=Math.max(u,l+1)}var s,d,m;c.push(r)})),o++,e.push(Kn(n.element,c,n.section)),i++}})),{grid:function(n,t){return{rows:n,columns:t}}(o,u),access:t,all:e,columns:r}},de=function(n){var t=ae(n);return se(t)},me=se,pe=function(n,t,e){var r=n.access[le(t,e)];return void 0!==r?m.some(r):m.none()},ge=function(n,t,e){var r=fe(n,(function(n){return e(t,n.element)}));return r.length>0?m.some(r[0]):m.none()},ve=fe,he=function(n){return W(n.all,(function(n){return n.cells}))},be=function(n){return function(n,t){var e=[];return Fn(n,(function(n,t){e.push(n)})),e}(n.columns)},we=function(n){return Wn(n.columns).length>0},ye=function(n,t){return m.from(n.columns[t])},xe=function(n,t){var e=t.column,r=t.column+t.colspan-1,o=t.row,u=t.row+t.rowspan-1;return e<=n.finishCol&&r>=n.startCol&&o<=n.finishRow&&u>=n.startRow},Ce=function(n,t){return t.column>=n.startCol&&t.column+t.colspan-1<=n.finishCol&&t.row>=n.startRow&&t.row+t.rowspan-1<=n.finishRow},Se=function(n,t,e){var r=ge(n,t,Nn),o=ge(n,e,Nn);return r.bind((function(n){return o.map((function(t){return e=n,r=t,{startRow:Math.min(e.row,r.row),startCol:Math.min(e.column,r.column),finishRow:Math.max(e.row+e.rowspan-1,r.row+r.rowspan-1),finishCol:Math.max(e.column+e.colspan-1,r.column+r.colspan-1)};var e,r}))}))},Te=function(n,t,e){return Se(n,t,e).map((function(t){var e=ve(n,r(xe,t));return E(e,(function(n){return n.element}))}))},Re=function(n,t){return ge(n,t,(function(n,t){return _n(t,n)})).map((function(n){return n.element}))},Oe=function(n,t,e){var r=Ae(n);return Te(r,t,e)},De=function(n,t,e,r,o){var u=Ae(n),i=Nn(n,e)?m.some(t):Re(u,t),c=Nn(n,o)?m.some(r):Re(u,r);return i.bind((function(n){return c.bind((function(t){return Te(u,n,t)}))}))},Ae=de,Be=function(n,t){ct(n).each((function(e){e.dom.insertBefore(t.dom,n.dom)}))},Ee=function(n,t){ft(n).fold((function(){ct(n).each((function(n){Ie(n,t)}))}),(function(n){Be(n,t)}))},Pe=function(n,t){(function(n){return dt(n,0)})(n).fold((function(){Ie(n,t)}),(function(e){n.dom.insertBefore(t.dom,e.dom)}))},Ie=function(n,t){n.dom.appendChild(t.dom)},Me=function(n,t){Be(n,t),Ie(t,n)},ke=function(n,t){P(t,(function(e,r){var o=0===r?n:t[r-1];Ee(o,e)}))},Ne=function(n,t){P(t,(function(t){Ie(n,t)}))},_e=function(n){n.dom.textContent="",P(st(n),(function(n){ze(n)}))},ze=function(n){var t=n.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},We=function(n){var t,e=st(n);e.length>0&&(t=n,P(e,(function(n){Be(t,n)}))),ze(n)},je=function(n,t){var e=function(t){return n(t)?m.from(t.dom.nodeValue):m.none()};return{get:function(t){if(!n(t))throw new Error("Can only get text value of a text node");return e(t).getOr("")},getOption:e,set:function(t,e){if(!n(t))throw new Error("Can only set raw text value of a text node");t.dom.nodeValue=e}}}(et),Fe=function(n){return je.get(n)},Le=function(n){return je.getOption(n)},He=function(n,t){return je.set(n,t)},qe=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function Ve(){return{up:t({selector:Ot,closest:Bt,predicate:Rt,all:at}),down:t({selector:St,predicate:yt}),styles:t({get:Lt,getRaw:qt,set:jt,remove:Vt}),attrs:t({get:Mt,set:Pt,remove:Nt,copyTo:function(n,t){var e=_t(n);It(t,e)}}),insert:t({before:Be,after:Ee,afterAll:ke,append:Ie,appendAll:Ne,prepend:Pe,wrap:Me}),remove:t({unwrap:We,remove:ze}),create:t({nu:In.fromTag,clone:function(n){return In.fromDom(n.dom.cloneNode(!1))},text:In.fromText}),query:t({comparePosition:function(n,t){return n.dom.compareDocumentPosition(t.dom)},prevSibling:lt,nextSibling:ft}),property:t({children:st,name:Jn,parent:ct,document:function(n){return it(n).dom},isText:et,isComment:nt,isElement:tt,getText:Fe,setText:He,isBoundary:function(n){return!!tt(n)&&("body"===Jn(n)||D(qe,Jn(n)))},isEmptyTag:function(n){return!!tt(n)&&D(["br","img","hr","input"],Jn(n))},isNonEditable:function(n){return tt(n)&&"false"===Mt(n,"contenteditable")}}),eq:Nn,is:zn}}var Ue=function(n,t,e,r){var o=t(n,e);return M(r,(function(e,r){var o=t(n,r);return $e(n,e,o)}),o)},$e=function(n,t,e){return t.bind((function(t){return e.filter(r(n.eq,t))}))},Ge=Ve(),Ke=function(n,t){return function(n,t,e){return e.length>0?function(n,t,e,r){return r(n,t,e[0],e.slice(1))}(n,t,e,Ue):m.none()}(Ge,(function(t,e){return n(e)}),t)},Xe=function(n){return Ot(n,"table")},Ye=function(n,t,e){var o=function(n){return function(t){return void 0!==e&&e(t)||Nn(t,n)}};return Nn(n,t)?m.some({boxes:m.some([n]),start:n,finish:t}):Xe(n).bind((function(u){return Xe(t).bind((function(i){if(Nn(u,i))return m.some({boxes:Oe(u,n,t),start:n,finish:t});if(_n(u,i)){var c=(l=xt(t,"td,th",o(u))).length>0?l[l.length-1]:t;return m.some({boxes:De(u,n,u,t,i),start:n,finish:c})}if(_n(i,u)){var l,f=(l=xt(n,"td,th",o(i))).length>0?l[l.length-1]:n;return m.some({boxes:De(i,n,u,t,i),start:n,finish:f})}return function(n,t,e){return function(n,t,e,o){void 0===o&&(o=a);var u=[t].concat(n.up().all(t)),i=[e].concat(n.up().all(e)),c=function(n){return _(n,o).fold((function(){return n}),(function(t){return n.slice(0,t+1)}))},l=c(u),f=c(i),s=N(l,(function(t){return A(f,function(n,t){return r(n.eq,t)}(n,t))}));return{firstpath:l,secondpath:f,shared:s}}(Ge,n,t,void 0)}(n,t).shared.bind((function(r){return Bt(r,"table",e).bind((function(e){var r=xt(t,"td,th",o(e)),c=r.length>0?r[r.length-1]:t,a=xt(n,"td,th",o(e)),l=a.length>0?a[a.length-1]:n;return m.some({boxes:De(e,n,u,t,i),start:l,finish:c})}))}))}))}))},Je=function(n,t){var e=St(n,t);return e.length>0?m.some(e):m.none()},Qe=function(n,t,e){return At(n,t).bind((function(t){return At(n,e).bind((function(n){return Ke(Xe,[t,n]).map((function(e){return{first:t,last:n,table:e}}))}))}))},Ze=function(n,t,e,r,o){return function(n,t){return N(n,(function(n){return Mn(n,t)}))}(n,o).bind((function(n){return function(n,t,e){return re(n).bind((function(r){return function(n,t,e,r){return ge(n,t,Nn).bind((function(t){var o=e>0?t.row+t.rowspan-1:t.row,u=r>0?t.column+t.colspan-1:t.column;return pe(n,o+e,u+r).map((function(n){return n.element}))}))}(Ae(r),n,t,e)}))}(n,t,e).bind((function(n){return function(n,t){return Ot(n,"table").bind((function(e){return At(e,t).bind((function(t){return Ye(t,n).bind((function(n){return n.boxes.map((function(t){return{boxes:t,start:n.start,finish:n.finish}}))}))}))}))}(n,r)}))}))},nr=function(n,t){return Je(n,t)},tr=function(n,t,e){return Qe(n,t,e).bind((function(t){var e=function(t){return Nn(n,t)},o="thead,tfoot,tbody,table",u=Ot(t.first,o,e),i=Ot(t.last,o,e);return u.bind((function(n){return i.bind((function(e){return Nn(n,e)?function(n,t,e){return function(n,t,e){return Se(n,t,e).bind((function(t){return function(n,t){for(var e=!0,o=r(Ce,t),u=t.startRow;u<=t.finishRow;u++)for(var i=t.startCol;i<=t.finishCol;i++)e=e&&pe(n,u,i).exists(o);return e?m.some(t):m.none()}(n,t)}))}(Ae(n),t,e)}(t.table,t.first,t.last):m.none()}))}))}))},er=function(n){if(!b(n))throw new Error("cases must be an array");if(0===n.length)throw new Error("there must be at least one case");var t=[],e={};return P(n,(function(r,o){var u=Wn(r);if(1!==u.length)throw new Error("one and only one name per case");var i=u[0],c=r[i];if(void 0!==e[i])throw new Error("duplicate key detected:"+i);if("cata"===i)throw new Error("cannot have a case named cata (sorry)");if(!b(c))throw new Error("case arguments must be an array");t.push(i),e[i]=function(){var e=arguments.length;if(e!==c.length)throw new Error("Wrong number of arguments to case "+i+". Expected "+c.length+" ("+c+"), got "+e);for(var r=new Array(e),u=0;u<r.length;u++)r[u]=arguments[u];var a=function(n){var e=Wn(n);if(t.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+e.join(","));if(!j(t,(function(n){return D(e,n)})))throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+t.join(", "));return n[i].apply(null,r)};return{fold:function(){if(arguments.length!==n.length)throw new Error("Wrong number of arguments to fold. Expected "+n.length+", got "+arguments.length);var t=arguments[o];return t.apply(null,r)},match:a,log:function(n){console.log(n,{constructors:t,constructor:i,params:r})}}}})),e},rr=er([{none:[]},{multiple:["elements"]},{single:["element"]}]),or=function(n,t,e,r){return n.fold(t,e,r)},ur=rr.none,ir=rr.multiple,cr=rr.single,ar=tinymce.util.Tools.resolve("tinymce.PluginManager"),lr=function(n,t,e){var r=n[e].element,o=In.fromTag("td");Ie(o,In.fromTag("br")),(t?Ie:Pe)(r,o)},fr=function(n,t){var e=function(n){return Mn(n.element,t)},r=ae(n),o=me(r),u=function(n,t){var e=n.grid.columns,r=n.grid.rows,o=e,u=0,i=0;return Fn(n.access,(function(n){if(t(n)){var e=n.row,c=e+n.rowspan-1,a=n.column,l=a+n.colspan-1;e<r?r=e:c>u&&(u=c),a<o?o=a:l>i&&(i=l)}})),function(n,t,e,r){return{minRow:n,minCol:t,maxRow:e,maxCol:r}}(r,o,u,i)}(o,e),i="th:not("+t+"),td:not("+t+")",c=Zt(n,"th,td",(function(n){return Mn(n,i)}));return P(c,ze),function(n,t,e,r){for(var o=t.grid.columns,u=t.grid.rows,i=0;i<u;i++)for(var c=!1,a=0;a<o;a++)i<e.minRow||i>e.maxRow||a<e.minCol||a>e.maxCol||(pe(t,i,a).filter(r).isNone()?lr(n,c,i):c=!0)}(r,o,u,e),function(n,t){var e=I(Qt(n,"tr"),(function(n){return 0===n.dom.childElementCount}));P(e,ze),t.minCol!==t.maxCol&&t.minRow!==t.maxRow||P(Qt(n,"th,td"),(function(n){Nt(n,"rowspan"),Nt(n,"colspan")})),Nt(n,"width"),Nt(n,"height"),Vt(n,"width"),Vt(n,"height")}(n,u),n},sr=function(n){return"img"===Jn(n)?1:Le(n).fold((function(){return st(n).length}),(function(n){return n.length}))},dr=["img","br"],mr=function(n){return Le(n).filter((function(n){return 0!==n.trim().length||n.indexOf("Â ")>-1})).isSome()||D(dr,Jn(n))},pr=function(n){return t=mr,(e=function(n){for(var r=0;r<n.childNodes.length;r++){var o=In.fromDom(n.childNodes[r]);if(t(o))return m.some(o);var u=e(n.childNodes[r]);if(u.isSome())return u}return m.none()})(n.dom);var t,e},gr=function(n){return vr(n,mr)},vr=function(n,t){var e=function(n){for(var r=st(n),o=r.length-1;o>=0;o--){var u=r[o];if(t(u))return m.some(u);var i=e(u);if(i.isSome())return i}return m.none()};return e(n)},hr=function(n,t){return In.fromDom(n.dom.cloneNode(t))},br=function(n){return hr(n,!1)},wr=function(n){return hr(n,!0)},yr={scope:["row","col"]},xr=function(){var n=In.fromTag("td");return Ie(n,In.fromTag("br")),n},Cr=function(){return In.fromTag("col")},Sr=function(){return In.fromTag("colgroup")},Tr=function(n,t,e){var r=function(n,t){var e=function(n,t){var e=In.fromTag(t),r=_t(n);return It(e,r),e}(n,t),r=st(wr(n));return Ne(e,r),e}(n,t);return Fn(e,(function(n,t){null===n?Nt(r,t):Pt(r,t,n)})),r},Rr=function(n){return n},Or=function(n){return function(){return In.fromTag("tr",n.dom)}},Dr=function(n,t,e){var r=function(n,t){var e,r,o;e=t,r=n.element.dom,o=e.dom,zt(r)&&zt(o)&&(o.style.cssText=r.style.cssText),Vt(t,"height"),1!==n.colspan&&Vt(n.element,"width")};return{col:function(t){var e=ut(t.element),o=In.fromTag(Jn(t.element),e.dom);return r(t,o),n(t.element,o),o},colgroup:Sr,row:Or(t),cell:function(t){var o=ut(t.element),u=In.fromTag(Jn(t.element),o.dom),i=e.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),c=i.length>0?function(n,t,e){return pr(n).map((function(r){var o=e.join(","),u=xt(r,o,(function(t){return Nn(t,n)}));return M(u,(function(n,t){var e=br(t);return Nt(e,"contenteditable"),Ie(n,e),e}),t)})).getOr(t)}(t.element,u,i):u;return Ie(c,In.fromTag("br")),r(t,u),function(n,t){Fn(yr,(function(e,r){return kt(n,r).filter((function(n){return D(e,n)})).each((function(n){return Pt(t,r,n)}))}))}(t.element,u),n(t.element,u),u},replace:Tr,gap:xr}},Ar=function(n){return{col:Cr,colgroup:Sr,row:Or(n),cell:xr,replace:Rr,gap:xr}},Br=function(n){return E(n,In.fromDom)},Er=function(n){return or(n.get(),t([]),e,F)},Pr=function(n){var t=function(n,t){return kt(n,t).exists((function(n){return parseInt(n,10)>1}))},e=Er(n);return e.length>0&&j(e,(function(n){return t(n,"rowspan")||t(n,"colspan")}))?m.some(e):m.none()},Ir=function(n,t,e){return or(t.get(),m.none,(function(t){return t.length<=1?m.none():tr(n,e.firstSelectedSelector,e.lastSelectedSelector).map((function(n){return{bounds:n,cells:t}}))}),m.none)},Mr={selected:"data-mce-selected",selectedSelector:"td[data-mce-selected],th[data-mce-selected]",firstSelected:"data-mce-first-selected",firstSelectedSelector:"td[data-mce-first-selected],th[data-mce-first-selected]",lastSelected:"data-mce-last-selected",lastSelectedSelector:"td[data-mce-last-selected],th[data-mce-last-selected]"},kr=function(n){return{element:n,mergable:m.none(),unmergable:m.none(),selection:[n]}},Nr=function(n,t,e){return{element:e,mergable:Ir(t,n,Mr),unmergable:Pr(n),selection:Er(n)}},_r=er([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),zr=V({},_r),Wr=function(n){for(var t=[],e=function(n){t.push(n)},r=0;r<n.length;r++)n[r].each(e);return t};function jr(n,t){var e=function(e){var r=t(e);if(r<=0||null===r){var o=Lt(e,n);return parseFloat(o)||0}return r},r=function(n,t){return k(t,(function(t,e){var r=Lt(n,e),o=void 0===r?0:parseInt(r,10);return isNaN(o)?t:t+o}),0)};return{set:function(t,e){if(!S(e)&&!e.match(/^[0-9]+$/))throw new Error(n+".set accepts only positive integer values. Value was "+e);var r=t.dom;zt(r)&&(r.style[n]=e+"px")},get:e,getOuter:e,aggregate:r,max:function(n,t,e){var o=r(n,e);return t>o?t-o:0}}}var Fr,Lr,Hr,qr=jr("width",(function(n){return n.dom.offsetWidth})),Vr=function(n){return qr.get(n)},Ur=function(n){return qr.getOuter(n)},$r=function(n){var t=n.grid,r=B(t.columns,e),o=B(t.rows,e);return E(r,(function(t){return Gr((function(){return W(o,(function(e){return pe(n,e,t).filter((function(n){return n.column===t})).toArray()}))}),(function(n){return 1===n.colspan}),(function(){return pe(n,0,t)}))}))},Gr=function(n,t,e){var r=n();return N(r,t).orThunk((function(){return m.from(r[0]).orThunk(e)})).map((function(n){return n.element}))},Kr=function(n){var r=n.grid,o=B(r.rows,e),u=B(r.columns,e);return E(o,(function(e){return Gr((function(){return W(u,(function(r){return pe(n,e,r).filter((function(n){return n.row===e})).fold(t([]),(function(n){return[n]}))}))}),(function(n){return 1===n.rowspan}),(function(){return pe(n,e,0)}))}))},Xr=function(n,t){return function(e){return"rtl"===Yr(e)?t:n}},Yr=function(n){return"rtl"===Lt(n,"direction")?"rtl":"ltr"},Jr=jr("height",(function(n){var t=n.dom;return bt(n)?t.getBoundingClientRect().height:t.offsetHeight})),Qr=function(n){return Jr.get(n)},Zr=function(n){return Jr.getOuter(n)},no=function(n,t){return{left:n,top:t,translate:function(e,r){return no(n+e,t+r)}}},to=no,eo=function(n,t){return void 0!==n?n:void 0!==t?t:0},ro=function(n){var t=n.dom.ownerDocument,e=t.body,r=t.defaultView,o=t.documentElement;if(e===n.dom)return to(e.offsetLeft,e.offsetTop);var u=eo(null==r?void 0:r.pageYOffset,o.scrollTop),i=eo(null==r?void 0:r.pageXOffset,o.scrollLeft),c=eo(o.clientTop,e.clientTop),a=eo(o.clientLeft,e.clientLeft);return oo(n).translate(i-a,u-c)},oo=function(n){var t=n.dom,e=t.ownerDocument.body;return e===t?to(e.offsetLeft,e.offsetTop):bt(n)?function(n){var t=n.getBoundingClientRect();return to(t.left,t.top)}(t):to(0,0)},uo=function(n,t){return{row:n,y:t}},io=function(n,t){return{col:n,x:t}},co=function(n){return ro(n).left+Ur(n)},ao=function(n){return ro(n).left},lo=function(n,t){return io(n,ao(t))},fo=function(n,t){return io(n,co(t))},so=function(n){return ro(n).top},mo=function(n,t){return uo(n,so(t))},po=function(n,t){return uo(n,so(t)+Zr(t))},go=function(n,t,e){if(0===e.length)return[];var r=E(e.slice(1),(function(t,e){return t.map((function(t){return n(e,t)}))})),o=e[e.length-1].map((function(n){return t(e.length-1,n)}));return r.concat([o])},vo={delta:e,positions:function(n){return go(mo,po,n)},edge:so},ho=Xr({delta:e,edge:ao,positions:function(n){return go(lo,fo,n)}},{delta:function(n){return-n},edge:co,positions:function(n){return go(fo,lo,n)}}),bo={delta:function(n,t){return ho(t).delta(n,t)},positions:function(n,t){return ho(t).positions(n,t)},edge:function(n){return ho(n).edge(n)}},wo={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},yo=(Fr="[eE][+-]?[0-9]+",Hr=["Infinity","[0-9]+\\."+(Lr=function(n){return"(?:"+n+")?"})("[0-9]+")+Lr(Fr),"\\.[0-9]+"+Lr(Fr),"[0-9]+"+Lr(Fr)].join("|"),new RegExp("^([+-]?(?:"+Hr+"))(.*)$")),xo=function(){var n=En().browser;return n.isIE()||n.isEdge()},Co=function(n,t,e){return function(n,t){var e=parseFloat(n);return isNaN(e)?t:e}(Lt(n,t),e)},So=function(n){return xo()?function(n){var t=n.dom.getBoundingClientRect().width;return"border-box"===Lt(n,"box-sizing")?t:t-Co(n,"padding-left",0)-Co(n,"padding-right",0)-(Co(n,"border-left-width",0)+Co(n,"border-right-width",0))}(n):Co(n,"width",Vr(n))},To=/(\d+(\.\d+)?)%/,Ro=/(\d+(\.\d+)?)px|em/,Oo=function(n,t){jt(n,"width",t+"px")},Do=function(n,t){jt(n,"width",t+"%")},Ao=function(n,t){jt(n,"height",t+"px")},Bo=function(n){var t=function(n){return qt(n,"height").getOrThunk((function(){return function(n){return xo()?function(n){var t=n.dom.getBoundingClientRect().height;return"border-box"===Lt(n,"box-sizing")?t:t-Co(n,"padding-top",0)-Co(n,"padding-bottom",0)-(Co(n,"border-top-width",0)+Co(n,"border-bottom-width",0))}(n):Co(n,"height",Qr(n))}(n)+"px"}))}(n);return t?function(n,t,e,r){var o=parseInt(n,10);return tn(n,"%")&&"table"!==Jn(t)?function(n,t,e,r){var o=re(n).map((function(n){var r=e(n);return Math.floor(t/100*r)})).getOr(t);return r(n,o),o}(t,o,e,r):o}(t,n,Qr,Ao):Qr(n)},Eo=function(n){return qt(n,"width").fold((function(){return m.from(Mt(n,"width"))}),(function(n){return m.some(n)}))},Po=function(n,t){return n/t.pixelWidth()*100},Io=function(n,t){return Eo(n).fold((function(){var e=Vr(n);return Po(e,t)}),(function(e){return function(n,t,e){var r=To.exec(t);if(null!==r)return parseFloat(r[1]);var o=So(n);return Po(o,e)}(n,e,t)}))},Mo=function(n,t){return Eo(n).fold((function(){return So(n)}),(function(e){return function(n,t,e){var r=Ro.exec(t);if(null!==r)return parseInt(r[1],10);var o=To.exec(t);return null!==o?function(n,t){return n/100*t.pixelWidth()}(parseFloat(o[1]),e):So(n)}(n,e,t)}))},ko=function(n){return function(n,t,e){return e(n)/$t(n,"rowspan")}(n,0,Bo)},No=function(n,t,e){jt(n,"width",t+e)},_o=function(n){return e=Vr,o=(r=t=n,m.from(r.dom.offsetParent).map(In.fromDom)).getOr(wt(ut(t))),e(t)/e(o)*100+"%";var t,e,r,o},zo=t(To),Wo=t(Ro),jo=("col",function(n){return tt(n)&&"col"===Jn(n)}),Fo=function(n,t,e){return qt(n,t).fold((function(){return e(n)+"px"}),(function(n){return n}))},Lo=function(n,t){return Fo(n,"width",(function(n){return jo(n)?Vr(n):Mo(n,t)}))},Ho=function(n){return Fo(n,"height",ko)},qo=function(n,t,e,r,o,u){return n.filter(r).fold((function(){return u(function(n,t){if(t<0||t>=n.length-1)return m.none();var e=n[t].fold((function(){var e=function(n){var t=T.call(n,0);return t.reverse(),t}(n.slice(0,t));return q(e,(function(n,t){return n.map((function(n){return{value:n,delta:t+1}}))}))}),(function(n){return m.some({value:n,delta:0})})),r=n[t+1].fold((function(){var e=n.slice(t+1);return q(e,(function(n,t){return n.map((function(n){return{value:n,delta:t+1}}))}))}),(function(n){return m.some({value:n,delta:1})}));return e.bind((function(n){return r.map((function(t){var e=t.delta+n.delta;return Math.abs(t.value-n.value)/e}))}))}(e,t))}),(function(n){return o(n)}))},Vo=function(n,t,r,o,u){var i=$r(n),a=we(n)?function(n){return E(be(n),(function(n){return m.from(n.element)}))}(n):i,l=[m.some(bo.edge(t))].concat(E(bo.positions(i,t),(function(n){return n.map((function(n){return n.x}))}))),f=c(Gt);return E(a,(function(n,t){return qo(n,t,l,f,(function(n){if(function(n){return!jo(n)||qt(n,"width").isSome()}(n))return r(n,u);var c,a=null!=(c=i[t])?e(c):m.none();return qo(a,t,l,f,(function(n){return o(m.some(Vr(n)))}),o)}),o)}))},Uo=function(n){return n.map((function(n){return n+"px"})).getOr("")},$o=function(n,t,e){return Vo(n,t,Mo,(function(n){return n.getOrThunk(e.minCellWidth)}),e)},Go=function(n,t,e,r,o){var u=Kr(n),i=[m.some(e.edge(t))].concat(E(e.positions(u,t),(function(n){return n.map((function(n){return n.y}))})));return E(u,(function(n,t){return qo(n,t,i,c(Kt),r,o)}))},Ko=function(n,t,e){for(var r=0,o=n;o<t;o++)r+=void 0!==e[o]?e[o]:0;return r},Xo=function(n,t){var e=he(n);return E(e,(function(n){var e=Ko(n.row,n.row+n.rowspan,t);return{element:n.element,height:e,rowspan:n.rowspan}}))},Yo=function(n,t,e){var r=function(n,t){return we(n)?function(n,t){var e=be(n);return E(e,(function(n,e){return{element:n.element,width:t[e],colspan:n.colspan}}))}(n,t):function(n,t){var e=he(n);return E(e,(function(n){var e=Ko(n.column,n.column+n.colspan,t);return{element:n.element,width:e,colspan:n.colspan}}))}(n,t)}(n,t);P(r,(function(n){e.setElementWidth(n.element,n.width)}))},Jo=function(n,e,r,o,u){var i=de(n),c=u.getCellDelta(e),a=u.getWidths(i,u),l=r===i.grid.columns-1,f=o.clampTableDelta(a,r,c,u.minCellWidth(),l),s=function(n,e,r,o,u){var i=n.slice(0),c=function(n,t){return 0===n.length?zr.none():1===n.length?zr.only(0):0===t?zr.left(0,1):t===n.length-1?zr.right(t-1,t):t>0&&t<n.length-1?zr.middle(t-1,t,t+1):zr.none()}(n,e),a=t(E(i,t(0)));return c.fold(a,(function(n){return o.singleColumnWidth(i[n],r)}),(function(n,t){return u.calcLeftEdgeDeltas(i,n,t,r,o.minCellWidth(),o.isRelative)}),(function(n,t,e){return u.calcMiddleDeltas(i,n,t,e,r,o.minCellWidth(),o.isRelative)}),(function(n,t){return u.calcRightEdgeDeltas(i,n,t,r,o.minCellWidth(),o.isRelative)}))}(a,r,f,u,o),d=E(s,(function(n,t){return n+a[t]}));Yo(i,d,u),o.resizeTable(u.adjustTableWidth,f,l)},Qo=function(n){return E(n,t(0))},Zo=function(n,t,e,r,o){return o(n.slice(0,t)).concat(r).concat(o(n.slice(e)))},nu=function(n){return function(t,e,r,o){if(n(r)){var u=Math.max(o,t[e]-Math.abs(r)),i=Math.abs(u-t[e]);return r>=0?i:-i}return r}},tu=nu((function(n){return n<0})),eu=nu(l),ru=function(n,e){var r=m.from(n.dom.documentElement).map(In.fromDom).getOr(n);return{parent:t(r),view:t(n),origin:t(to(0,0)),isResizable:e}},ou=er([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),uu=function(n,t,e){var r=e.substring(0,e.length-n.length),o=parseFloat(r);return r===o.toString()?t(o):ou.invalid(e)},iu=V(V({},ou),{from:function(n){return tn(n,"%")?uu("%",ou.percent,n):tn(n,"px")?uu("px",ou.pixels,n):ou.invalid(n)}}),cu=function(n,e,r){var o=iu.from(r),u=j(n,(function(n){return"0px"===n}))?function(n,e){var r=n.fold((function(){return t("")}),(function(n){return t(n/e+"px")}),(function(){return t(100/e+"%")}));return B(e,r)}(o,n.length):function(n,t,e){return n.fold((function(){return t}),(function(n){return function(n,t,e){var r=e/t;return E(n,(function(n){return iu.from(n).fold((function(){return n}),(function(n){return n*r+"px"}),(function(n){return n/100*e+"px"}))}))}(t,e,n)}),(function(n){return function(n,t){return E(n,(function(n){return iu.from(n).fold((function(){return n}),(function(n){return n/t*100+"%"}),(function(n){return n+"%"}))}))}(t,e)}))}(o,n,e);return fu(u)},au=function(n,r){return 0===n.length?r:M(n,(function(n,r){return iu.from(r).fold(t(0),e,e)+n}),0)},lu=function(n,e){return iu.from(n).fold(t(n),(function(n){return n+e+"px"}),(function(n){return n+e+"%"}))},fu=function(n){if(0===n.length)return n;var t=M(n,(function(n,t){var e=iu.from(t).fold((function(){return{value:t,remainder:0}}),(function(n){return function(n,t){var e=Math.floor(n);return{value:e+"px",remainder:n-e}}(n)}),(function(n){return{value:n+"%",remainder:0}}));return{output:[e.value].concat(n.output),remainder:n.remainder+e.remainder}}),{output:[],remainder:0}),e=t.output;return e.slice(0,e.length-1).concat([lu(e[e.length-1],Math.round(t.remainder))])},su=iu.from,du=function(n){return su(n).fold(t("px"),t("px"),t("%"))},mu=function(n,t,e,r){var o=de(n),u=o.all,i=he(o),c=be(o);t.each((function(t){var e=du(t),u=Vr(n),a=function(n,t,e){return Vo(n,t,Lo,Uo,e)}(o,n,r),l=cu(a,u,t);we(o)?function(n,t,e){P(t,(function(t,r){var o=au([n[r]],Yt());jt(t.element,"width",o+e)}))}(l,c,e):function(n,t,e){P(t,(function(t){var r=n.slice(t.column,t.colspan+t.column),o=au(r,Yt());jt(t.element,"width",o+e)}))}(l,i,e),jt(n,"width",t)})),e.each((function(t){var e=du(t),r=Qr(n),c=function(n,t,e){return Go(n,t,e,Ho,Uo)}(o,n,vo);!function(n,t,e,r){P(e,(function(t){var e=n.slice(t.row,t.rowspan+t.row),o=au(e,Jt());jt(t.element,"height",o+r)})),P(t,(function(t,e){jt(t.element,"height",n[e])}))}(cu(c,r,t),u,i,e),jt(n,"height",t)}))},pu=function(n){return Eo(n).exists((function(n){return To.test(n)}))},gu=function(n){return Eo(n).exists((function(n){return Ro.test(n)}))},vu=function(n){return Eo(n).isNone()},hu=_o,bu=function(n){return de(n).grid},wu=function(n){var t=[];return{bind:function(n){if(void 0===n)throw new Error("Event bind error: undefined handler");t.push(n)},unbind:function(n){t=I(t,(function(t){return t!==n}))},trigger:function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o={};P(n,(function(n,t){o[n]=e[t]})),P(t,(function(n){n(o)}))}}},yu=function(n){return{registry:Ln(n,(function(n){return{bind:n.bind,unbind:n.unbind}})),trigger:Ln(n,(function(n){return n.trigger}))}},xu=function(n){return n.slice(0).sort()},Cu=function(n,t){var e=I(t,(function(t){return!D(n,t)}));e.length>0&&function(n){throw new Error("Unsupported keys for object: "+xu(n).join(", "))}(e)},Su=function(n){return function(n,t){return function(n,t,e){if(0===t.length)throw new Error("You must specify at least one required field.");var r;return function(n,t){if(!b(t))throw new Error("The required fields must be an array. Was: "+t+".");P(t,(function(t){if(!v(t))throw new Error("The value "+t+" in the "+n+" fields was not a string.")}))}("required",t),r=xu(t),N(r,(function(n,t){return t<r.length-1&&n===r[t+1]})).each((function(n){throw new Error("The field: "+n+" occurs more than once in the combined fields: ["+r.join(", ")+"].")})),function(r){var o=Wn(r);j(t,(function(n){return D(o,n)}))||function(n,t){throw new Error("All required keys ("+xu(n).join(", ")+") were not specified. Specified keys were: "+xu(t).join(", ")+".")}(t,o),n(t,o);var u=I(t,(function(n){return!e.validate(r[n],n)}));return u.length>0&&function(n,t){throw new Error("All values need to be of type: "+t+". Keys ("+xu(n).join(", ")+") were not.")}(u,e.label),r}}(n,t,{validate:C,label:"function"})}(Cu,n)},Tu=Su(["compare","extract","mutate","sink"]),Ru=Su(["element","start","stop","destroy"]),Ou=Su(["forceDrop","drop","move","delayDrop"]);function Du(){var t,e,r={onEvent:n,reset:n},o=(t=m.none(),{onEvent:function(n,r){r.extract(n).each((function(n){(function(n,e){var r=t.map((function(t){return n.compare(t,e)}));return t=m.some(e),r})(r,n).each((function(n){e.trigger.move(n)}))}))},reset:function(){t=m.none()},events:(e=yu({move:wu(["info"])})).registry}),u=r;return{on:function(){u.reset(),u=o},off:function(){u.reset(),u=r},isOn:function(){return u===o},onEvent:function(n,t){u.onEvent(n,t)},events:o.events}}var Au=function(n){var t,e,r=In.fromDom(function(n){if(pt()&&x(n.target)){var t=In.fromDom(n.target);if(tt(t)&&ht(t)&&n.composed&&n.composedPath){var e=n.composedPath();if(e)return L(e,0)}}return m.from(n.target)}(n).getOr(n.target)),o=function(){return n.stopPropagation()},u=function(){return n.preventDefault()},i=(t=u,e=o,function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t(e.apply(null,n))});return function(n,t,e,r,o,u,i){return{target:n,x:t,y:e,stop:r,prevent:o,kill:u,raw:i}}(r,n.clientX,n.clientY,o,u,i,n)},Bu=function(n,t,e,r){n.dom.removeEventListener(t,e,r)},Eu=l,Pu=function(n,t,e){return function(n,t,e,o){return function(n,t,e,o,u){var i=function(n,t){return function(e){n(e)&&t(Au(e))}}(e,o);return n.dom.addEventListener(t,i,u),{unbind:r(Bu,n,t,i,u)}}(n,t,e,o,!1)}(n,t,Eu,e)},Iu=Au,Mu=function(n){return void 0!==n.dom.classList},ku=function(n,t){return function(n,t,e){var r=function(n,t){var e=Mt(n,t);return void 0===e||""===e?[]:e.split(" ")}(n,t).concat([e]);return Pt(n,t,r.join(" ")),!0}(n,"class",t)},Nu=function(n,t){Mu(n)?n.dom.classList.add(t):ku(n,t)},_u=function(n,t){return Mu(n)&&n.dom.classList.contains(t)},zu=function(n){var t=n.replace(/\./g,"-");return{resolve:function(n){return t+"-"+n}}},Wu=zu("ephox-dragster"),ju=Wu.resolve,Fu=Tu({compare:function(n,t){return to(t.left-n.left,t.top-n.top)},extract:function(n){return m.some(to(n.x,n.y))},sink:function(n,t){var e=function(n){var t=V({layerClass:ju("blocker")},n),e=In.fromTag("div");return Pt(e,"role","presentation"),Ft(e,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),Nu(e,ju("blocker")),Nu(e,t.layerClass),{element:function(){return e},destroy:function(){ze(e)}}}(t),r=Pu(e.element(),"mousedown",n.forceDrop),o=Pu(e.element(),"mouseup",n.drop),u=Pu(e.element(),"mousemove",n.move),i=Pu(e.element(),"mouseout",n.delayDrop);return Ru({element:e.element,start:function(n){Ie(n,e.element())},stop:function(){ze(e.element())},destroy:function(){e.destroy(),o.unbind(),u.unbind(),i.unbind(),r.unbind()}})},mutate:function(n,t){n.mutate(t.left,t.top)}}),Lu=function(n){return"true"===Mt(n,"contenteditable")},Hu=zu("ephox-snooker"),qu=Hu.resolve,Vu=qu("resizer-bar"),Uu=qu("resizer-rows"),$u=qu("resizer-cols"),Gu=function(n){var t=St(n.parent(),"."+Vu);P(t,ze)},Ku=function(n,t,e){var r=n.origin();P(t,(function(t){t.each((function(t){var o=e(r,t);Nu(o,Vu),Ie(n.parent(),o)}))}))},Xu=function(n,t,e,r,o){var u=ro(e),i=t.isResizable,c=r.length>0?vo.positions(r,e):[],a=c.length>0?function(n,t){return W(n.all,(function(n,e){return t(n.element)?[e]:[]}))}(n,i):[];!function(n,t,e,r){Ku(n,t,(function(n,t){var o=function(n,t,e,r,o){var u=In.fromTag("div");return Ft(u,{position:"absolute",left:t+"px",top:e-3.5+"px",height:"7px",width:r+"px"}),It(u,{"data-row":n,role:"presentation"}),u}(t.row,e.left-n.left,t.y-n.top,r);return Nu(o,Uu),o}))}(t,I(c,(function(n,t){return A(a,(function(n){return t===n}))})),u,Ur(e));var l=o.length>0?bo.positions(o,e):[],f=l.length>0?function(n,t){var e=[];return B(n.grid.columns,(function(r){ye(n,r).map((function(n){return n.element})).forall(t)&&e.push(r)})),I(e,(function(e){var r=ve(n,(function(n){return n.column===e}));return j(r,(function(n){return t(n.element)}))}))}(n,i):[];!function(n,t,e,r){Ku(n,t,(function(n,t){var o,u,i,c,a,l=(o=t.col,u=t.x-n.left,i=e.top-n.top,c=r,a=In.fromTag("div"),Ft(a,{position:"absolute",left:u-3.5+"px",top:i+"px",height:c+"px",width:"7px"}),It(a,{"data-column":o,role:"presentation"}),a);return Nu(l,$u),l}))}(t,I(l,(function(n,t){return A(f,(function(n){return t===n}))})),u,Zr(e))},Yu=function(n,t){if(Gu(n),n.isResizable(t)){var e=de(t),r=Kr(e),o=$r(e);Xu(e,n,t,r,o)}},Ju=function(n,t){var e=St(n.parent(),"."+Vu);P(e,t)},Qu=function(n){Ju(n,(function(n){jt(n,"display","none")}))},Zu=function(n){Ju(n,(function(n){jt(n,"display","block")}))},ni=qu("resizer-bar-dragging"),ti=function(n){var t=function(){var n=yu({drag:wu(["xDelta","yDelta","target"])}),t=m.none(),e=function(){var n=yu({drag:wu(["xDelta","yDelta"])});return{mutate:function(t,e){n.trigger.drag(t,e)},events:n.registry}}();return e.events.drag.bind((function(e){t.each((function(t){n.trigger.drag(e.xDelta,e.yDelta,t)}))})),{assign:function(n){t=m.some(n)},get:function(){return t},mutate:e.mutate,events:n.registry}}(),e=function(n,t){return void 0===t&&(t={}),function(n,t,e){var r,o,u=!1,i=yu({start:wu([]),stop:wu([])}),c=Du(),a=function(){s.stop(),c.isOn()&&(c.off(),i.trigger.stop())},l=(r=a,o=null,{cancel:function(){null!==o&&(clearTimeout(o),o=null)},throttle:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];null!==o&&clearTimeout(o),o=setTimeout((function(){r.apply(null,n),o=null}),200)}});c.events.move.bind((function(e){t.mutate(n,e.info)}));var f=function(n){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];u&&n.apply(null,t)}},s=t.sink(Ou({forceDrop:a,drop:f(a),move:f((function(n){l.cancel(),c.onEvent(n,t)})),delayDrop:f(l.throttle)}),e);return{element:s.element,go:function(n){s.start(n),c.on(),i.trigger.start()},on:function(){u=!0},off:function(){u=!1},destroy:function(){s.destroy()},events:i.registry}}(n,void 0!==t.mode?t.mode:Fu,t)}(t,{}),o=m.none(),u=function(n,t){return m.from(Mt(n,t))};t.events.drag.bind((function(n){u(n.target,"data-row").each((function(t){var e=Xt(n.target,"top");jt(n.target,"top",e+n.yDelta+"px")})),u(n.target,"data-column").each((function(t){var e=Xt(n.target,"left");jt(n.target,"left",e+n.xDelta+"px")}))}));var i=function(n,t){return Xt(n,t)-Ut(n,"data-initial-"+t,0)};e.events.stop.bind((function(){t.get().each((function(t){o.each((function(e){u(t,"data-row").each((function(n){var r=i(t,"top");Nt(t,"data-initial-top"),s.trigger.adjustHeight(e,r,parseInt(n,10))})),u(t,"data-column").each((function(n){var r=i(t,"left");Nt(t,"data-initial-left"),s.trigger.adjustWidth(e,r,parseInt(n,10))})),Yu(n,e)}))}))}));var c=function(r,o){s.trigger.startAdjust(),t.assign(r),Pt(r,"data-initial-"+o,Xt(r,o)),Nu(r,ni),jt(r,"opacity","0.2"),e.go(n.parent())},a=Pu(n.parent(),"mousedown",(function(n){var t;t=n.target,_u(t,Uu)&&c(n.target,"top"),function(n){return _u(n,$u)}(n.target)&&c(n.target,"left")})),l=function(t){return Nn(t,n.view())},f=Pu(n.view(),"mouseover",(function(t){var e;(e=t.target,Bt(e,"table",l).filter((function(n){return function(n,t){return Bt(n,"[contenteditable]",t)}(n,l).exists(Lu)}))).fold((function(){bt(t.target)&&Gu(n)}),(function(t){o=m.some(t),Yu(n,t)}))})),s=yu({adjustHeight:wu(["table","delta","row"]),adjustWidth:wu(["table","delta","column"]),startAdjust:wu([])});return{destroy:function(){a.unbind(),f.unbind(),e.destroy(),Gu(n)},refresh:function(t){Yu(n,t)},on:e.on,off:e.off,hideBars:r(Qu,n),showBars:r(Zu,n),events:s.registry}},ei=function(n,t,e){var r=vo,o=bo,u=ti(n),i=yu({beforeResize:wu(["table","type"]),afterResize:wu(["table","type"]),startDrag:wu([])});return u.events.adjustHeight.bind((function(n){var t=n.table;i.trigger.beforeResize(t,"row"),function(n,t,e,r){var o=de(n),u=function(n,t,e){return Go(n,t,e,ko,(function(n){return n.getOrThunk(Jt)}))}(o,n,r),i=E(u,(function(n,r){return e===r?Math.max(t+n,Jt()):n})),c=Xo(o,i),a=function(n,t){return E(n.all,(function(n,e){return{element:n.element,height:t[e]}}))}(o,i);P(a,(function(n){Ao(n.element,n.height)})),P(c,(function(n){Ao(n.element,n.height)}));var l=M(i,(function(n,t){return n+t}),0);Ao(n,l)}(t,r.delta(n.delta,t),n.row,r),i.trigger.afterResize(t,"row")})),u.events.startAdjust.bind((function(n){i.trigger.startDrag()})),u.events.adjustWidth.bind((function(n){var r=n.table;i.trigger.beforeResize(r,"col");var u=o.delta(n.delta,r),c=e(r);Jo(r,u,n.column,t,c),i.trigger.afterResize(r,"col")})),{on:u.on,off:u.off,hideBars:u.hideBars,showBars:u.showBars,destroy:u.destroy,events:i.registry}},ri=function(n,t){return n.fire("newrow",{node:t})},oi=function(n,t){return n.fire("newcell",{node:t})},ui=function(n,t,e){n.fire("TableModified",V(V({},e),{table:t}))},ii={"border-collapse":"collapse",width:"100%"},ci={border:"1"},ai="preservetable",li=function(n){return n.getParam("table_sizing_mode","auto")},fi=function(n){return n.getParam("table_responsive_width")},si=function(n){return n.getParam("table_default_attributes",ci,"object")},di=function(n){return n.getParam("table_default_styles",function(n){if(bi(n)){var t=n.getBody().offsetWidth;return V(V({},ii),{width:t+"px"})}return wi(n)?qn(ii,(function(n,t){return"width"!==t})):ii}(n),"object")},mi=function(n){return n.getParam("table_cell_advtab",!0,"boolean")},pi=function(n){return n.getParam("table_row_advtab",!0,"boolean")},gi=function(n){return n.getParam("table_advtab",!0,"boolean")},vi=function(n){return n.getParam("table_style_by_css",!1,"boolean")},hi=function(n){return"relative"===li(n)||!0===fi(n)},bi=function(n){return"fixed"===li(n)||!1===fi(n)},wi=function(n){return"responsive"===li(n)},yi=function(n){return n.getParam("table_use_colgroups",!1,"boolean")},xi=function(n){var t="section",e=n.getParam("table_header_type",t,"string");return D(["section","cells","sectionCells","auto"],e)?e:t},Ci=function(n){var t=n.getParam("table_column_resizing",ai,"string");return N(["preservetable","resizetable"],(function(n){return n===t})).getOr(ai)},Si=function(n){return"preservetable"===Ci(n)},Ti=function(n){var t=n.getParam("table_clone_elements");return v(t)?m.some(t.split(/[ ,]/)):Array.isArray(t)?m.some(t):m.none()},Ri=function(n){return n.nodeName.toLowerCase()},Oi=function(n){return In.fromDom(n.getBody())},Di=function(n){return n.getBoundingClientRect().width},Ai=function(n){return n.getBoundingClientRect().height},Bi=function(n){return function(t){return Nn(t,Oi(n))}},Ei=function(n){return/^\d+(\.\d+)?$/.test(n)?n+"px":n},Pi=function(n){Nt(n,"data-mce-style");var t=function(n){return Nt(n,"data-mce-style")};P(te(n),t),P(ee(n),t)},Ii=function(n,t){var e=n.dom.getStyle(t,"width")||n.dom.getAttrib(t,"width");return m.from(e).filter(rn)},Mi=function(n){return/^(\d+(\.\d+)?)%$/.test(n)},ki=function(n){return In.fromDom(n.selection.getStart())},Ni=function(n){var t=n;return{get:function(){return t},set:function(n){t=n}}},_i=function(n,t){var e=Ni(parseFloat(n)),r=Ni(Vr(t));return{width:e.get,pixelWidth:r.get,getWidths:function(n,e){return function(n,t,e){return Vo(n,t,Io,(function(n){return n.fold((function(){return e.minCellWidth()}),(function(n){return n/e.pixelWidth()*100}))}),e)}(n,t,e)},getCellDelta:function(n){return n/r.get()*100},singleColumnWidth:function(n,t){return[100-n]},minCellWidth:function(){return Yt()/r.get()*100},setElementWidth:Do,adjustTableWidth:function(n){var o=e.get(),u=o+n/100*o;Do(t,u),e.set(u),r.set(Vr(t))},isRelative:!0,label:"percent"}},zi=function(n,t){var r=Ni(n),o=r.get;return{width:o,pixelWidth:o,getWidths:function(n,e){return $o(n,t,e)},getCellDelta:e,singleColumnWidth:function(n,t){return[Math.max(Yt(),n+t)-n]},minCellWidth:Yt,setElementWidth:Oo,adjustTableWidth:function(n){var e=o()+n;Oo(t,e),r.set(e)},isRelative:!1,label:"pixel"}},Wi=function(e){return Eo(e).fold((function(){return function(e){var r=function(){return Vr(e)},o=t(0);return{width:r,pixelWidth:r,getWidths:function(n,t){return $o(n,e,t)},getCellDelta:o,singleColumnWidth:t([0]),minCellWidth:o,setElementWidth:n,adjustTableWidth:n,isRelative:!0,label:"none"}}(e)}),(function(n){return function(n,t){var e=zo().exec(t);if(null!==e)return _i(e[1],n);var r=Wo().exec(t);if(null!==r){var o=parseInt(r[1],10);return zi(o,n)}var u=Vr(n);return zi(u,n)}(e,n)}))},ji=zi,Fi=_i,Li=function(n,t){if(hi(n)){var e=Ii(n,t.dom).filter(Mi).getOrThunk((function(){return hu(t)}));return Fi(e,t)}return bi(n)?ji(Vr(t),t):Wi(t)},Hi=function(n){Nt(n,"width")},qi=function(n,t){!function(n,t){var e=_o(n);mu(n,m.some(e),m.none(),t),Hi(n)}(t,Li(n,t))},Vi=function(n,t){!function(n,t){var e=function(n){return Vr(n)+"px"}(n);mu(n,m.some(e),m.none(),t),Hi(n)}(t,Li(n,t))},Ui=function(n){Vt(n,"width");var t=ee(n),e=t.length>0?t:te(n);P(e,(function(n){Vt(n,"width"),Hi(n)})),Hi(n)},$i="bar-",Gi=function(n){return"false"!==Mt(n,"data-mce-resize")},Ki=function(n){var e,r,o=m.none(),u=m.none(),i=m.none(),c=function(n){return"TABLE"===n.nodeName},a=function(){return u},l=function(t){return Li(n,t)},f=function(){return Si(n)?{resizeTable:function(n,t,e){e&&n(t)},clampTableDelta:function(n,t,e,r,o){if(o){if(e>=0)return e;var u=k(n,(function(n,t){return n+t-r}),0);return Math.max(-u,e)}return tu(n,t,e,r)},calcLeftEdgeDeltas:e=function(n,t,e,r,o){var u=eu(n,r>=0?e:t,r,o);return Zo(n,t,e+1,[u,-u],Qo)},calcMiddleDeltas:function(n,t,r,o,u,i){return e(n,r,o,u,i)},calcRightEdgeDeltas:function(n,e,r,o,u,i){if(i)return Qo(n);var c=o/n.length;return E(n,t(c))}}:function(){var n=function(n,t,e,r){var o=(100+e)/100,u=Math.max(r,(n[t]+e)/o);return E(n,(function(n,e){return(e===t?u:n/o)-n}))},t=function(t,e,r,o,u,i){return i?n(t,e,o,u):function(n,t,e,r,o){var u=tu(n,t,r,o);return Zo(n,t,e+1,[u,0],Qo)}(t,e,r,o,u)};return{resizeTable:function(n,t){return n(t)},clampTableDelta:tu,calcLeftEdgeDeltas:t,calcMiddleDeltas:function(n,e,r,o,u,i,c){return t(n,r,o,u,i,c)},calcRightEdgeDeltas:function(t,e,r,o,u,i){if(i)return n(t,r,o,u);var c=tu(t,r,o,u);return Qo(t.slice(0,r)).concat([c])}}}();var e};return n.on("init",(function(){var e=function(n,e){return n.inline?function(n,e,r){return{parent:t(e),view:t(n),origin:t(to(0,0)),isResizable:r}}(Oi(n),(r=In.fromTag("div"),Ft(r,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),Ie(wt(In.fromDom(document)),r),r),e):ru(In.fromDom(n.getDoc()),e);var r}(n,Gi);if(i=m.some(e),function(n){var t=n.getParam("object_resizing",!0);return v(t)?"table"===t:t}(n)&&function(n){return n.getParam("table_resize_bars",!0,"boolean")}(n)){var r=f(),c=ei(e,r,l);c.on(),c.events.startDrag.bind((function(t){o=m.some(n.selection.getRng())})),c.events.beforeResize.bind((function(t){var e=t.table.dom;!function(n,t,e,r,o){n.fire("ObjectResizeStart",{target:t,width:e,height:r,origin:o})}(n,e,Di(e),Ai(e),$i+t.type)})),c.events.afterResize.bind((function(t){var e=t.table,r=e.dom;Pi(e),o.each((function(t){n.selection.setRng(t),n.focus()})),function(n,t,e,r,o){n.fire("ObjectResized",{target:t,width:e,height:r,origin:o})}(n,r,Di(r),Ai(r),$i+t.type),n.undoManager.add()})),u=m.some(c)}})),n.on("ObjectResizeStart",(function(t){var o=t.target;if(c(o)){var u=In.fromDom(o);P(n.dom.select(".mce-clonedresizable"),(function(t){n.dom.addClass(t,"mce-"+Ci(n)+"-columns")})),!gu(u)&&bi(n)?Vi(n,u):!pu(u)&&hi(n)&&qi(n,u),vu(u)&&nn(t.origin,$i)&&qi(n,u),e=t.width,r=wi(n)?"":Ii(n,o).getOr("")}})),n.on("ObjectResized",(function(t){var o=t.target;if(c(o)){var u=In.fromDom(o),i=t.origin;nn(i,"corner-")&&function(t,o,u){var i=tn(o,"e");if(""===r&&qi(n,t),u!==e&&""!==r){jt(t,"width",r);var c=f(),a=l(t),s=Si(n)||i?function(n){return bu(n).columns}(t)-1:0;Jo(t,u-e,s,c,a)}else if(Mi(r)){var d=parseFloat(r.replace("%",""));jt(t,"width",u*d/e+"%")}(function(n){return/^(\d+(\.\d+)?)px$/.test(n)})(r)&&function(n){var t=de(n);we(t)||P(te(n),(function(n){var t=Lt(n,"width");jt(n,"width",t),Nt(n,"width")}))}(t)}(u,i,t.width),Pi(u),ui(n,u.dom)}})),n.on("SwitchMode",(function(){a().each((function(t){n.mode.isReadOnly()?t.hideBars():t.showBars()}))})),{lazyResize:a,lazyWire:function(){return i.getOr(ru(In.fromDom(n.getBody()),Gi))},destroy:function(){u.each((function(n){n.destroy()})),i.each((function(t){!function(n,t){n.inline&&ze(t.parent())}(n,t)}))}}},Xi=function(n,t){return{element:n,offset:t}},Yi=function(n,t,e){return n.property().isText(t)&&0===n.property().getText(t).trim().length||n.property().isComment(t)?e(t).bind((function(t){return Yi(n,t,e).orThunk((function(){return m.some(t)}))})):m.none()},Ji=function(n,t){return n.property().isText(t)?n.property().getText(t).length:n.property().children(t).length},Qi=function(n,t){var e=Yi(n,t,n.query().prevSibling).getOr(t);if(n.property().isText(e))return Xi(e,Ji(n,e));var r=n.property().children(e);return r.length>0?Qi(n,r[r.length-1]):Xi(e,Ji(n,e))},Zi=Qi,nc=Ve(),tc=function(n,t){(function(n){return Eo(n).bind((function(n){return t=n,e=["fixed","relative","empty"],m.from(yo.exec(t)).bind((function(n){var t=Number(n[1]),r=n[2];return function(n,t){return A(t,(function(t){return A(wo[t],(function(t){return n===t}))}))}(r,e)?m.some({value:t,unit:r}):m.none()}));var t,e}))})(n).each((function(e){var r=e.value/2;No(n,r,e.unit),No(t,r,e.unit)}))},ec=function(n,t,e){n.cells[t]=e},rc=function(n,t){return Yn(t,n.section)},oc=function(n,t){var e=n.cells,r=E(e,t);return Yn(r,n.section)},uc=function(n,t){return n.cells[t]},ic=function(n,t){return uc(n,t).element},cc=function(n){return n.cells.length},ac=function(n){var t=function(n,t){for(var e=[],r=[],o=0,u=n.length;o<u;o++){var i=n[o];(c=i,"colgroup"===c.section?e:r).push(i)}var c;return{pass:e,fail:r}}(n);return{rows:t.fail,cols:t.pass}},lc=function(n,t,e,r){e===r?Nt(n,t):Pt(n,t,e)},fc=function(n,t,e){H(Ct(n,t)).fold((function(){return Pe(n,e)}),(function(n){return Ee(n,e)}))},sc=function(n,t){var e=[],r=[],o=function(n){return E(n,(function(n){n.isNew&&e.push(n.element);var t=n.element;return _e(t),P(n.cells,(function(n){n.isNew&&r.push(n.element),lc(n.element,"colspan",n.colspan,1),lc(n.element,"rowspan",n.rowspan,1),Ie(t,n.element)})),t}))},u=function(n){return W(n,(function(n){return E(n.cells,(function(n){return lc(n.element,"span",n.colspan,1),n.element}))}))},i=function(t,e){var r=function(n,t){var e=Dt(n,t).getOrThunk((function(){var e=In.fromTag(t,ut(n).dom);return"thead"===t?fc(n,"caption,colgroup",e):"colgroup"===t?fc(n,"caption",e):Ie(n,e),e}));return _e(e),e}(n,e),i=("colgroup"===e?u:o)(t);Ne(r,i)},c=function(t,e){t.length>0?i(t,e):function(t){Dt(n,t).each(ze)}(e)},a=[],l=[],f=[],s=[];return P(t,(function(n){switch(n.section){case"thead":a.push(n);break;case"tbody":l.push(n);break;case"tfoot":f.push(n);break;case"colgroup":s.push(n)}})),c(s,"colgroup"),c(a,"thead"),c(l,"tbody"),c(f,"tfoot"),{newRows:e,newCells:r}},dc=function(n,t){if(0===n.length)return 0;var e=n[0];return _(n,(function(n){return!t(e.element,n.element)})).fold((function(){return n.length}),(function(n){return n}))},mc=function(n,t){var e=E(n,(function(n){return E(n.cells,a)}));return E(n,(function(r,o){return u=W(r.cells,(function(r,u){if(!1===e[o][u]){var i=function(n,t,e,r){var o=function(n,t){return n[t]}(n,t).cells.slice(e),u=dc(o,r),i=function(n,t){return E(n,(function(n){return uc(n,t)}))}(n,e).slice(t);return{colspan:u,rowspan:dc(i,r)}}(n,o,u,t);return function(n,t,r,o){for(var u=n;u<n+r;u++)for(var i=t;i<t+o;i++)e[u][i]=!0}(o,u,i.rowspan,i.colspan),[(c=r.element,a=i.rowspan,l=i.colspan,f=r.isNew,{element:c,rowspan:a,colspan:l,isNew:f})]}return[];var c,a,l,f})),i=r.section,{details:u,section:i};var u,i}))},pc=function(n,t,e){var r=[];if(we(n)){var o=E(be(n),(function(n){return Xn(n.element,e)}));r.push(Yn(o,"colgroup"))}for(var u=0;u<n.grid.rows;u++){for(var i=[],c=0;c<n.grid.columns;c++){var a=pe(n,u,c).map((function(n){return Xn(n.element,e)})).getOrThunk((function(){return Xn(t.gap(),!0)}));i.push(a)}var l=Yn(i,n.all[u].section);r.push(l)}return r},gc=function(n,t){return function(n,t){return E(n,(function(n){var e=function(n){return q(n,(function(n){return ct(n.element).map((function(n){var t=ct(n).isNone();return Xn(n,t)}))})).getOrThunk((function(){return Xn(t.row(),!0)}))}(n.details);return function(n,t,e,r){return{element:n,cells:t,section:e,isNew:r}}(e.element,n.details,n.section,e.isNew)}))}(mc(n,Nn),t)},vc=function(n,t){return q(n.all,(function(n){return N(n.cells,(function(n){return Nn(t,n.element)}))}))},hc=function(n,t,e,r,o){return function(u,i,c,a,l){var f=de(i);return t(f,c).map((function(t){var e=function(n,t){return pc(n,t,!1)}(f,a),r=n(e,t,Nn,o(a));return{grid:gc(r.grid,a),cursor:r.cursor}})).fold((function(){return m.none()}),(function(n){var t=sc(i,n.grid),o=m.from(l).getOrThunk((function(){return Wi(i)}));return e(i,n.grid,o),r(i),Yu(u,i),m.some({cursor:n.cursor,newRows:t.newRows,newCells:t.newCells})}))}},bc=function(n,t){return ne(t.element).bind((function(t){return vc(n,t)}))},wc=function(n,t){var e=E(t.selection,(function(t){return ne(t).bind((function(t){return vc(n,t)}))})),r=Wr(e);return r.length>0?m.some({cells:r,generators:t.generators,clipboard:t.clipboard}):m.none()},yc=function(n,t){var e=E(t.selection,(function(t){return ne(t).bind((function(t){return vc(n,t)}))})),r=Wr(e);return r.length>0?m.some(r):m.none()},xc=function(n,t,e,r){for(var o=ac(n).rows,u=!0,i=0;i<o.length;i++)for(var c=0;c<cc(o[0]);c++){var a=e(ic(o[i],c),t);!0===a&&!1===u?ec(o[i],c,Xn(r(),!0)):!0===a&&(u=!1)}return n},Cc=function(n){return{is:function(t){return n===t},isValue:l,isError:a,getOr:t(n),getOrThunk:t(n),getOrDie:t(n),or:function(t){return Cc(n)},orThunk:function(t){return Cc(n)},fold:function(t,e){return e(n)},map:function(t){return Cc(t(n))},mapError:function(t){return Cc(n)},each:function(t){t(n)},bind:function(t){return t(n)},exists:function(t){return t(n)},forall:function(t){return t(n)},toOptional:function(){return m.some(n)}}},Sc=function(t){return{is:a,isValue:a,isError:l,getOr:e,getOrThunk:function(n){return n()},getOrDie:function(){return(n=String(t),function(){throw new Error(n)})();var n},or:function(n){return n},orThunk:function(n){return n()},fold:function(n,e){return n(t)},map:function(n){return Sc(t)},mapError:function(n){return Sc(n(t))},each:n,bind:function(n){return Sc(t)},exists:a,forall:l,toOptional:m.none}},Tc={value:Cc,error:Sc,fromOption:function(n,t){return n.fold((function(){return Sc(t)}),Cc)}},Rc=function(n,t){return{rowDelta:0,colDelta:cc(n[0])-cc(t[0])}},Oc=function(n,t){return{rowDelta:n.length-t.length,colDelta:0}},Dc=function(n,t,e){var r="colgroup"===t.section?e.col:e.cell;return E(n,(function(){return Xn(r(),!0)}))},Ac=function(n,t,e){return n.concat(B(t,(function(){var t=n[n.length-1];return rc(t,Dc(t.cells,t,e))})))},Bc=function(n,t,r){return E(n,(function(n){var o=Dc(B(t,e),n,r);return rc(n,n.cells.concat(o))}))},Ec=function(n,t,r){var o=t.colDelta<0?Bc:e;return(t.rowDelta<0?Ac:e)(o(n,Math.abs(t.colDelta),r),Math.abs(t.rowDelta),r)},Pc=function(n,t,e,o){var u=r(o,uc(n[t],e).element),i=n[t];return n.length>1&&cc(i)>1&&(e>0&&u(ic(i,e-1))||e<i.cells.length-1&&u(ic(i,e+1))||t>0&&u(ic(n[t-1],e))||t<n.length-1&&u(ic(n[t+1],e)))},Ic=function(n,t,e,r,o){!function(n,t,e,r){t>0&&t<n[0].cells.length&&P(n,(function(n){var o=n.cells[t-1],u=n.cells[t];e(u.element,o.element)&&ec(n,t,Xn(r(),!0))}))}(t,n,o,r.cell);var u=Oc(e,t),i=Ec(e,u,r),c=Oc(t,i),a=Ec(t,c,r);return E(a,(function(t,e){var r=t.cells.slice(0,n).concat(i[e].cells).concat(t.cells.slice(n,t.cells.length));return rc(t,r)}))},Mc=function(n,t,e,r,o){!function(n,t,e,r){var o=ac(n).rows;if(t>0&&t<o.length){var u=function(n,t){return k(n,(function(n,e){return A(n,(function(n){return t(n.element,e.element)}))?n:n.concat([e])}),[])}(o[t-1].cells,e);P(u,(function(n){for(var u=m.none(),i=function(t){for(var i=function(i){var c=o[t].cells[i];e(c.element,n.element)&&(u.isNone()&&(u=m.some(r())),u.each((function(n){ec(o[t],i,Xn(n,!0))})))},c=0;c<cc(o[0]);c++)i(c)},c=t;c<o.length;c++)i(c)}))}}(t,n,o,r.cell);var u=Rc(e,t),i=Ec(e,u,r),c=Rc(t,i),a=Ec(t,c,r),l=ac(a),f=l.cols,s=l.rows;return f.concat(s.slice(0,n)).concat(i).concat(s.slice(n,s.length))},kc=function(n,t,e,r,o){var u=ac(n),i=u.rows,c=u.cols,a=i.slice(0,t),l=i.slice(t),f=oc(i[e],(function(n,e){return t>0&&t<i.length&&r(ic(i[t-1],e),ic(i[t],e))?uc(i[t],e):Xn(o(n.element,r),!0)}));return c.concat(a).concat([f]).concat(l)},Nc=function(n,t,e,r,o){return E(n,(function(n){var u=t>0&&t<cc(n)&&r(ic(n,t-1),ic(n,t)),i=function(n,t,e,r,o,u,i){return"colgroup"!==e&&r?uc(n,t):Xn(i(ic(n,o),u),!0)}(n,t,n.section,u,e,r,o);return function(n,t,e){var r=n.cells,o=r.slice(0,t),u=r.slice(t),i=o.concat([e]).concat(u);return rc(n,i)}(n,t,i)}))},_c=function(n,t,e,r){return E(n,(function(n){return oc(n,(function(n){return function(n){return A(t,(function(t){return e(n.element,t.element)}))}(n)?Xn(r(n.element,e),!0):n}))}))},zc=function(n,t,e,r){return void 0!==ic(n[t],e)&&t>0&&r(ic(n[t-1],e),ic(n[t],e))},Wc=function(n,t,e){return t>0&&e(ic(n,t-1),ic(n,t))},jc=function(n,t,e,r){var o=W(n,(function(r,o){return zc(n,o,t,e)||Wc(r,t,e)?[]:[uc(r,t)]}));return _c(n,o,e,r)},Fc=function(n,t,e,r){var o=ac(n).rows,u=o[t],i=W(u.cells,(function(n,r){return zc(o,t,r,e)||Wc(u,r,e)?[]:[n]}));return _c(n,i,e,r)},Lc=Su(["cell","row","replace","gap","col","colgroup"]),Hc=function(n){return{element:n,colspan:Ut(n,"colspan",1),rowspan:Ut(n,"rowspan",1)}},qc=function(n,t){void 0===t&&(t=Hc),Lc(n);var e=Ni(m.none()),r=function(r){var u=function(e){return function(t){switch(Jn(t.element)){case"col":return n.col(t);default:return n.cell(t)}}(t(e))}(r);return e.get().isNone()&&e.set(m.some(u)),o=m.some({item:r,replacement:u}),u},o=m.none();return{getOrInit:function(n,t){return o.fold((function(){return r(n)}),(function(e){return t(n,e.item)?e.replacement:r(n)}))},cursor:e.get}},Vc=function(n,t){return function(e){var r=Ni(m.none());Lc(e);var o=[],u=function(u){var i={scope:n},c=e.replace(u,t,i);return o.push({item:u,sub:c}),r.get().isNone()&&r.set(m.some(c)),c};return{replaceOrInit:function(n,t){return function(n,t){return N(o,(function(e){return t(e.item,n)}))}(n,t).fold((function(){return u(n)}),(function(e){return t(n,e.item)?e.sub:u(n)}))},cursor:r.get}}},Uc=function(n){Lc(n);var t=Ni(m.none());return{combine:function(e){return t.get().isNone()&&t.set(m.some(e)),function(){var t=n.cell({element:e,colspan:1,rowspan:1});return Vt(t,"width"),Vt(e,"width"),t}},cursor:t.get}},$c=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],Gc=Ve(),Kc=function(n){return function(n,t){var e=n.property().name(t);return D($c,e)}(Gc,n)},Xc=function(n){return function(n,t){var e=n.property().name(t);return D(["ol","ul"],e)}(Gc,n)},Yc=function(n){var t,e=function(n){return"br"===Jn(n)},r=function(n){return gr(n).bind((function(t){var r=ft(t).map((function(n){return!!Kc(n)||!!function(n,t){return D(["br","img","hr","input"],n.property().name(t))}(Gc,n)&&"img"!==Jn(n)})).getOr(!1);return ct(t).map((function(o){return!0===r||("li"===Jn(u=o)||Rt(u,Xc).isSome())||e(t)||Kc(o)&&!Nn(n,o)?[]:[In.fromTag("br")];var u}))})).getOr([])},o=0===(t=W(n,(function(n){var t=st(n);return function(n){return j(n,(function(n){return e(n)||et(n)&&0===Fe(n).trim().length}))}(t)?[]:t.concat(r(n))}))).length?[In.fromTag("br")]:t;_e(n[0]),Ne(n[0],o)},Jc=function(n){0===te(n).length&&ze(n)},Qc=function(n,t){return{grid:n,cursor:t}},Zc=function(n,t,e){var r=ac(n).rows;return na(r,t,e).orThunk((function(){return na(r,0,0)}))},na=function(n,t,e){return m.from(n[t]).bind((function(n){return m.from(n.cells[e]).bind((function(n){return m.from(n.element)}))}))},ta=function(n,t,e){var r=ac(n).rows;return Qc(n,na(r,t,e))},ea=function(n){return k(n,(function(n,t){return A(n,(function(n){return n.row===t.row}))?n:n.concat([t])}),[]).sort((function(n,t){return n.row-t.row}))},ra=function(n){return k(n,(function(n,t){return A(n,(function(n){return n.column===t.column}))?n:n.concat([t])}),[]).sort((function(n,t){return n.column-t.column}))},oa=function(n,t,e){var r,o,u=(r=n,o=e.section,ie(r,(function(){return o}))),i=me(u);return pc(i,t,!0)},ua=function(n,t){var e=I(n,t);return 0===e.length?m.some("td"):e.length===n.length?m.some("th"):m.none()},ia=function(n,t,e){var r=me(t),o=e.getWidths(r,e);Yo(r,o,e)},ca=hc((function(n,t,e,r){var o=t[0].row,u=t[0].row,i=ea(t),c=k(i,(function(n,t){return kc(n,u,o,e,r.getOrInit)}),n);return ta(c,u,t[0].column)}),yc,n,n,qc),aa=hc((function(n,t,e,r){var o=ea(t),u=o[o.length-1].row,i=o[o.length-1].row+o[o.length-1].rowspan,c=k(o,(function(n,t){return kc(n,i,u,e,r.getOrInit)}),n);return ta(c,i,t[0].column)}),yc,n,n,qc),la=hc((function(n,t,e,r){var o=ra(t),u=o[0].column,i=o[0].column,c=k(o,(function(n,t){return Nc(n,i,u,e,r.getOrInit)}),n);return ta(c,t[0].row,i)}),yc,ia,n,qc),fa=hc((function(n,t,e,r){var o=t[t.length-1].column,u=t[t.length-1].column+t[t.length-1].colspan,i=ra(t),c=k(i,(function(n,t){return Nc(n,u,o,e,r.getOrInit)}),n);return ta(c,t[0].row,u)}),yc,ia,n,qc),sa=hc((function(n,t,e,r){var o=ra(t),u=function(n,t,e){var r=E(n,(function(n){var r=n.cells.slice(0,t).concat(n.cells.slice(e+1));return Yn(r,n.section)}));return I(r,(function(n){return n.cells.length>0}))}(n,o[0].column,o[o.length-1].column),i=Zc(u,t[0].row,t[0].column);return Qc(u,i)}),yc,ia,Jc,qc),da=hc((function(n,t,e,r){var o=ea(t),u=function(n,t,e){var r=ac(n),o=r.rows;return r.cols.concat(o.slice(0,t)).concat(o.slice(e+1))}(n,o[0].row,o[o.length-1].row),i=Zc(u,t[0].row,t[0].column);return Qc(u,i)}),yc,n,Jc,qc),ma=(hc((function(n,t,e,r){var o=jc(n,t.column,e,r.replaceOrInit);return ta(o,t.row,t.column)}),bc,n,n,Vc("row","th")),hc((function(n,t,e,r){var o=ra(t),u=k(o,(function(n,t){return jc(n,t.column,e,r.replaceOrInit)}),n);return ta(u,t[0].row,t[0].column)}),yc,n,n,Vc("row","th"))),pa=(hc((function(n,t,e,r){var o=jc(n,t.column,e,r.replaceOrInit);return ta(o,t.row,t.column)}),bc,n,n,Vc(null,"td")),hc((function(n,t,e,r){var o=ra(t),u=k(o,(function(n,t){return jc(n,t.column,e,r.replaceOrInit)}),n);return ta(u,t[0].row,t[0].column)}),yc,n,n,Vc(null,"td"))),ga=(hc((function(n,t,e,r){var o=Fc(n,t.row,e,r.replaceOrInit);return ta(o,t.row,t.column)}),bc,n,n,Vc("col","th")),hc((function(n,t,e,r){var o=ea(t),u=k(o,(function(n,t){return Fc(n,t.row,e,r.replaceOrInit)}),n);return ta(u,t[0].row,t[0].column)}),yc,n,n,Vc("col","th")),hc((function(n,t,e,r){var o=Fc(n,t.row,e,r.replaceOrInit);return ta(o,t.row,t.column)}),bc,n,n,Vc(null,"td")),hc((function(n,t,e,r){var o=ea(t),u=k(o,(function(n,t){return Fc(n,t.row,e,r.replaceOrInit)}),n);return ta(u,t[0].row,t[0].column)}),yc,n,n,Vc(null,"td")),hc((function(n,e,r,o){var u=e.cells;Yc(u);var i=function(n,t,e,r){var o=ac(n).rows;if(0===o.length)return n;for(var u=t.startRow;u<=t.finishRow;u++)for(var i=t.startCol;i<=t.finishCol;i++)ec(o[u],i,Xn(r(),!1));return n}(n,e.bounds,0,t(u[0]));return Qc(i,m.from(u[0]))}),(function(n,t){return t.mergable}),n,n,Uc)),va=hc((function(n,t,e,r){var o=M(t,(function(n,t){return xc(n,t,e,r.combine(t))}),n);return Qc(o,m.from(t[0]))}),(function(n,t){return t.unmergable}),ia,n,Uc),ha=hc((function(n,t,e,r){var o,u,i=function(n,t){var e=de(n);return pc(e,t,!0)}(t.clipboard,t.generators);return function(n,t,e,r,o){return function(n,t,e){if(n.row>=t.length||n.column>cc(t[0]))return Tc.error("invalid start address out of table bounds, row: "+n.row+", column: "+n.column);var r=t.slice(n.row),o=r[0].cells.slice(n.column),u=cc(e[0]),i=e.length;return Tc.value({rowDelta:r.length-i,colDelta:o.length-u})}(n,t,e).map((function(u){var i=Ec(t,u,r);return function(n,t,e,r,o){for(var u=n.row,i=n.column,c=u+e.length,a=i+cc(e[0]),l=u;l<c;l++)for(var f=i;f<a;f++){Pc(t,l,f,o)&&xc(t,ic(t[l],f),o,r.cell);var s=ic(e[l-u],f-i),d=r.replace(s);ec(t[l],f,Xn(d,!0))}return t}(n,i,e,r,o)}))}((o=t.row,u=t.column,{row:o,column:u}),n,i,t.generators,e).fold((function(){return Qc(n,m.some(t.element))}),(function(n){var e=Zc(n,t.row,t.column);return Qc(n,e)}))}),(function(n,t){return ne(t.element).bind((function(e){return vc(n,e).map((function(n){return V(V({},n),{generators:t.generators,clipboard:t.clipboard})}))}))}),ia,n,qc),ba=hc((function(n,t,e,r){var o=ac(n).rows,u=t.cells[0].column,i=o[t.cells[0].row],c=oa(t.clipboard,t.generators,i),a=Ic(u,n,c,t.generators,e),l=Zc(a,t.cells[0].row,t.cells[0].column);return Qc(a,l)}),wc,n,n,qc),wa=hc((function(n,t,e,r){var o=ac(n).rows,u=t.cells[t.cells.length-1].column+t.cells[t.cells.length-1].colspan,i=o[t.cells[0].row],c=oa(t.clipboard,t.generators,i),a=Ic(u,n,c,t.generators,e),l=Zc(a,t.cells[0].row,t.cells[0].column);return Qc(a,l)}),wc,n,n,qc),ya=hc((function(n,t,e,r){var o=ac(n).rows,u=t.cells[0].row,i=o[u],c=oa(t.clipboard,t.generators,i),a=Mc(u,n,c,t.generators,e),l=Zc(a,t.cells[0].row,t.cells[0].column);return Qc(a,l)}),wc,n,n,qc),xa=hc((function(n,t,e,r){var o=ac(n).rows,u=t.cells[t.cells.length-1].row+t.cells[t.cells.length-1].rowspan,i=o[t.cells[0].row],c=oa(t.clipboard,t.generators,i),a=Mc(u,n,c,t.generators,e),l=Zc(a,t.cells[0].row,t.cells[0].column);return Qc(a,l)}),wc,n,n,qc),Ca=function(n,t){var e=de(n);return yc(e,t).bind((function(n){var t=n[n.length-1],r=n[0].column,o=t.column+t.colspan,u=z(E(e.all,(function(n){return I(n.cells,(function(n){return n.column>=r&&n.column<o}))})));return ua(u,(function(n){return"th"===Jn(n.element)}))})).getOr("")},Sa=function(n){return Ri(n.parentNode)},Ta=function(n,t){var e="thead"===Sa(t),r=!A(t.cells,(function(n){return"th"!==Ri(n)}));return e||r?m.some({thead:e,ths:r}):m.none()},Ra=function(n,t){return"thead"===(e=Ta(0,t).fold((function(){return Sa(t)}),(function(n){return"thead"})))?"header":"tfoot"===e?"footer":"body";var e},Oa=function(n,t,e){var r=n.getParent(t,"table"),o=t.parentNode,u=Ri(o);if(e!==u){var i=n.select(e,r)[0];if(!i){i=n.create(e);var c=r.firstChild;"thead"===e?H(Ct(In.fromDom(r),"caption,colgroup")).fold((function(){return r.insertBefore(i,c)}),(function(t){return n.insertAfter(i,t.dom)})):r.appendChild(i)}"tbody"===e&&"thead"===u&&i.firstChild?i.insertBefore(t,i.firstChild):i.appendChild(t),o.hasChildNodes()||n.remove(o)}},Da=function(n,t,e,r){var o=n.dom,u=function(n,t,e){if(x(e)&&Ri(t)!==e){var r=n.dom.rename(t,e);return oi(n,r),r}return t}(n,t,e);return y(r)||o.setAttrib(u,"scope",r),u},Aa=function(n,t,e,r){return P(t,(function(t){return Da(n,t,e,r)}))},Ba=function(n,t,e){var r,o=n.dom;if("header"===e){var u=xi(n),i="auto"===u?(r=re(In.fromDom(t.cells[0])).map((function(n){return oe(n)})).getOr([]),q(r,(function(n){return Ta(0,n.dom)})).map((function(n){return n.thead&&n.ths?"sectionCells":n.thead?"section":"cells"})).getOr("section")):u;Aa(n,t.cells,"section"===i?"td":"th","col"),Oa(o,t,"cells"===i?"tbody":"thead")}else Aa(n,t.cells,"td",null),Oa(o,t,"footer"===e?"tfoot":"tbody")},Ea=function(n){return function(t){var e=Jn(t),r="col"===e||"colgroup"===e?function(n){return re(n).bind((function(n){return nr(n,Mr.firstSelectedSelector)})).fold((function(){return n}),(function(n){return n[0]}))}(t):t;return Bt(r,n)}},Pa=Ea("th,td"),Ia=Ea("th,td,caption"),Ma=function(n,t){return Pa(n).map((function(n){return Er(t)})).getOr([])},ka=function(n,t){var e,r,o,u=Pa(n),i=u.bind((function(n){return re(n)})).map((function(n){return oe(n)}));return(e=u,r=i,o=function(n,e){return I(e,(function(e){return A(Br(e.dom.cells),(function(e){return"1"===Mt(e,t)||Nn(e,n)}))}))},e.isSome()&&r.isSome()?m.some(o(e.getOrDie(),r.getOrDie())):m.none()).getOr([])},Na={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},_a=function(n,t,e,r){return B(n,(function(n){return function(n,t,e,r){for(var o=In.fromTag("tr"),u=0;u<n;u++){var i=In.fromTag(r<t||u<e?"th":"td");u<e&&Pt(i,"scope","row"),r<t&&Pt(i,"scope","col"),Ie(i,In.fromTag("br")),Ie(o,i)}return o}(t,e,r,n)}))},za=function(n,t){n.selection.select(t.dom,!0),n.selection.collapse(!0)},Wa=function(n,t,e,o,u){var i=di(n),c={styles:i,attributes:si(n),colGroups:yi(n)};return n.undoManager.ignore((function(){var r=function(n,t,e,r,o,u){void 0===u&&(u=Na);var i=In.fromTag("table"),c="cells"!==o;Ft(i,u.styles),It(i,u.attributes),u.colGroups&&Ie(i,function(n){var t=In.fromTag("colgroup");return B(n,(function(){return Ie(t,In.fromTag("col"))})),t}(t));var a=Math.min(n,e);if(c&&e>0){var l=In.fromTag("thead");Ie(i,l);var f=_a(e,t,"sectionCells"===o?a:0,r);Ne(l,f)}var s=In.fromTag("tbody");Ie(i,s);var d=_a(c?n-a:n,t,c?0:e,r);return Ne(s,d),i}(e,t,u,o,xi(n),c);Pt(r,"data-mce-id","__mce");var i=function(n){var t=In.fromTag("div"),e=In.fromDom(n.dom.cloneNode(!0));return Ie(t,e),function(n){return n.dom.innerHTML}(t)}(r);n.insertContent(i),n.addVisual()})),At(Oi(n),'table[data-mce-id="__mce"]').map((function(t){return bi(n)?Vi(n,t):wi(n)?Ui(t):(hi(n)||function(n){return v(n)&&-1!==n.indexOf("%")}(i.width))&&qi(n,t),Pi(t),Nt(t,"data-mce-id"),function(n,t){P(St(t,"tr"),(function(t){ri(n,t.dom),P(St(t,"th,td"),(function(t){oi(n,t.dom)}))}))}(n,t),function(n,t){At(t,"td,th").each(r(za,n))}(n,t),t.dom})).getOr(null)},ja=function(n,t,e,r,o){void 0===r&&(r={});var u=function(n){return S(n)&&n>0};if(u(t)&&u(e)){var i=r.headerRows||0,c=r.headerColumns||0;return Wa(n,e,t,c,i)}return console.error(o),null},Fa=function(n){return function(){return n().fold((function(){return[]}),(function(n){return E(n,(function(n){return n.dom}))}))}},La=function(n){return function(t){var e=t.length>0?m.some(Br(t)):m.none();n(e)}},Ha=function(n){return function(t,e,r){void 0===r&&(r={});var o=ja(n,e,t,r,"Invalid values for insertTable - rows and columns values are required to insert a table.");return n.undoManager.add(),o}},qa=function(n,t,e){var r=Ut(n,t,1);1===e||r<=1?Nt(n,t):Pt(n,t,Math.min(e,r))},Va=tinymce.util.Tools.resolve("tinymce.util.Tools"),Ua=function(n,t,e){return function(t,r){for(var o=0;o<r.length;o++){var u=n.getStyle(r[o],e);if(void 0===t&&(t=u),t!==u)return""}return t}(void 0,n.select("td,th",t))},$a=function(n,t,e){e&&n.formatter.apply("align"+e,{},t)},Ga=function(n,t){Va.each("left center right".split(" "),(function(e){n.formatter.remove("align"+e,{},t)}))},Ka=function(n,t){return function(n,t){return t.concat(E(n,(function(n){var t=n.text||n.title;return function(n){return t=n,Un(t,"menu")&&void 0!==t.menu&&null!==t.menu;var t}(n)?{text:t,items:Ka(n.menu)}:{text:t,value:n.value}})))}(n,t||[])},Xa=function(n){return function(t){return nn(t,"rgb")?n.toHex(t):t}},Ya=function(n,t){var e=In.fromDom(t);return{borderwidth:qt(e,"border-width").getOr(""),borderstyle:qt(e,"border-style").getOr(""),bordercolor:qt(e,"border-color").map(Xa(n)).getOr(""),backgroundcolor:qt(e,"background-color").map(Xa(n)).getOr("")}},Ja=function(n){var t=n[0],e=n.slice(1);return P(e,(function(n){P(Wn(t),(function(e){Fn(n,(function(n,r){var o=t[e];""!==o&&e===r&&o!==n&&(t[e]="")}))}))})),t},Qa=function(n){var t=[{name:"borderstyle",type:"listbox",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:"cell"===n?[{name:"borderwidth",type:"input",label:"Border width"}].concat(t):t}},Za=function(n,t,e,r){return N(n,(function(n){return e.formatter.matchNode(r,t+n)})).getOr("")},nl=r(Za,["left","center","right"],"align"),tl=r(Za,["top","middle","bottom"],"valign"),el=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"listbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"listbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"listbox",label:"H Align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"listbox",label:"V Align",items:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}],rl=function(n){return el.concat(function(n){var t=Ka(function(n){return n.getParam("table_cell_class_list",[],"array")}(n));return t.length>0?m.some({name:"class",type:"listbox",label:"Class",items:t}):m.none()}(n).toArray())},ol=function(n){return function(t,e){var r=t.dom;return{setAttrib:function(t,o){n&&!o||r.setAttrib(e,t,o)},setStyle:function(t,o){n&&!o||r.setStyle(e,t,o)},setFormat:function(r,o){n&&!o||(""===o?t.formatter.remove(r,{value:null},e,!0):t.formatter.apply(r,{value:o},e))}}}},ul={normal:ol(!1),ifTruthy:ol(!0)},il=function(n){return re(n[0]).map((function(t){var e=de(t),r=he(e),o=I(r,(function(t){return A(n,(function(n){return Nn(t.element,n)}))}));return E(o,(function(n){return{element:n.element.dom,column:ye(e,n.column).map((function(n){return n.element.dom}))}}))}))},cl=function(n,t,e){var r=e.getData();e.close(),n.undoManager.transact((function(){(function(n,t,e){var r=1===t.length;if(t.length>=1){var o=re(t[0]);il(t).each((function(t){P(t,(function(t){var o=Da(n,t.element,e.celltype),u=r?ul.normal(n,o):ul.ifTruthy(n,o);!function(n,t,e){n.setAttrib("scope",e.scope),n.setAttrib("class",e.class),n.setStyle("height",Ei(e.height)),t.setStyle("width",Ei(e.width))}(u,t.column.map((function(t){return r?ul.normal(n,t):ul.ifTruthy(n,t)})).getOr(u),e),mi(n)&&function(n,t){n.setFormat("tablecellbackgroundcolor",t.backgroundcolor),n.setFormat("tablecellbordercolor",t.bordercolor),n.setFormat("tablecellborderstyle",t.borderstyle),n.setFormat("tablecellborderwidth",Ei(t.borderwidth))}(u,e),r&&(Ga(n,o),function(n,t){Va.each("top middle bottom".split(" "),(function(e){n.formatter.remove("valign"+e,{},t)}))}(n,o)),e.halign&&$a(n,o,e.halign),e.valign&&function(n,t,e){e&&n.formatter.apply("valign"+e,{},t)}(n,o,e.valign)}))})),o.each((function(t){return ui(n,t.dom)}))}})(n,t,r),n.focus()}))},al=function(n,t){var e=Ma(ki(n),t);if(0!==e.length){var o=function(n,t){var e=il(t).map((function(t){return E(t,(function(t){return function(n,t,e,r){var o=n.dom,u=r.getOr(t),i=function(n,t){return o.getStyle(n,t)||o.getAttrib(n,t)};return V({width:i(u,"width"),height:i(t,"height"),scope:o.getAttrib(t,"scope"),celltype:Ri(t),class:o.getAttrib(t,"class",""),halign:nl(n,t),valign:tl(n,t)},e?Ya(o,t):{})}(n,t.element,mi(n),t.column)}))}));return Ja(e.getOrDie())}(n,e),u={type:"tabpanel",tabs:[{title:"General",name:"general",items:rl(n)},Qa("cell")]},i={type:"panel",items:[{type:"grid",columns:2,items:rl(n)}]};n.windowManager.open({title:"Cell Properties",size:"normal",body:mi(n)?u:i,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o,onSubmit:r(cl,n,e)})}},ll=[{type:"listbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"}]},{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],fl=function(n){return ll.concat(function(n){var t=Ka(function(n){return n.getParam("table_row_class_list",[],"array")}(n));return t.length>0?m.some({name:"class",type:"listbox",label:"Class",items:t}):m.none()}(n).toArray())},sl=function(n,t,e,r){var o=r.getData();r.close(),n.undoManager.transact((function(){(function(n,t,e,r){var o=1===t.length;P(t,(function(t){r.type!==Ri(t.parentNode)&&Ba(n,t,r.type);var u=o?ul.normal(n,t):ul.ifTruthy(n,t);!function(n,t){n.setAttrib("scope",t.scope),n.setAttrib("class",t.class),n.setStyle("height",Ei(t.height))}(u,r),pi(n)&&function(n,t){n.setStyle("background-color",t.backgroundcolor),n.setStyle("border-color",t.bordercolor),n.setStyle("border-style",t.borderstyle)}(u,r),r.align!==e.align&&(Ga(n,t),$a(n,t,r.align))})),re(In.fromDom(t[0])).each((function(t){return ui(n,t.dom)}))})(n,t,e,o),n.focus()}))},dl=function(n){var t=ka(ki(n),Mr.selected);if(0!==t.length){var e=E(t,(function(t){return function(n,t,e){var r=n.dom;return V({height:r.getStyle(t,"height")||r.getAttrib(t,"height"),scope:r.getAttrib(t,"scope"),class:r.getAttrib(t,"class",""),type:Ra(0,t),align:nl(n,t)},e?Ya(r,t):{})}(n,t.dom,pi(n))})),o=Ja(e),u={type:"tabpanel",tabs:[{title:"General",name:"general",items:fl(n)},Qa("row")]},i={type:"panel",items:[{type:"grid",columns:2,items:fl(n)}]};n.windowManager.open({title:"Row Properties",size:"normal",body:pi(n)?u:i,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o,onSubmit:r(sl,n,E(t,(function(n){return n.dom})),o)})}},ml=tinymce.util.Tools.resolve("tinymce.Env"),pl=function(n,t,e){var r=e?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],o=function(n){return n.getParam("table_appearance_options",!0,"boolean")}(n)?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],u=t.length>0?[{type:"listbox",name:"class",label:"Class",items:t}]:[];return r.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(o).concat([{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(u)},gl=function(n,t,e,r){if("TD"===t.tagName||"TH"===t.tagName)v(e)?n.setStyle(t,e,r):n.setStyle(t,e);else if(t.children)for(var o=0;o<t.children.length;o++)gl(n,t.children[o],e,r)},vl=function(n,t,e){var r,o=n.dom,u=e.getData();e.close(),""===u.class&&delete u.class,n.undoManager.transact((function(){if(!t){var e=parseInt(u.cols,10)||1,i=parseInt(u.rows,10)||1;t=Wa(n,e,i,0,0)}!function(n,t,e){var r,o=n.dom,u={},i={};if(u.class=e.class,i.height=Ei(e.height),o.getAttrib(t,"width")&&!vi(n)?u.width=(r=e.width)?r.replace(/px$/,""):"":i.width=Ei(e.width),vi(n)?(i["border-width"]=Ei(e.border),i["border-spacing"]=Ei(e.cellspacing)):(u.border=e.border,u.cellpadding=e.cellpadding,u.cellspacing=e.cellspacing),vi(n)&&t.children)for(var c=0;c<t.children.length;c++)gl(o,t.children[c],{"border-width":Ei(e.border),padding:Ei(e.cellpadding)}),gi(n)&&gl(o,t.children[c],{"border-color":e.bordercolor});gi(n)&&(i["background-color"]=e.backgroundcolor,i["border-color"]=e.bordercolor,i["border-style"]=e.borderstyle),u.style=o.serializeStyle(V(V({},di(n)),i)),o.setAttribs(t,V(V({},si(n)),u)),ui(n,t)}(n,t,u),(r=o.select("caption",t)[0])&&!u.caption&&o.remove(r),!r&&u.caption&&((r=o.create("caption")).innerHTML=ml.ie?"Â ":'<br data-mce-bogus="1"/>',t.insertBefore(r,t.firstChild)),""===u.align?Ga(n,t):$a(n,t,u.align),n.focus(),n.addVisual()}))},hl=function(n,t){var e,o=n.dom,u=function(n,t){var e,r,o,u,i=di(n),c=si(n),a=t?(e=n.dom,{borderstyle:Vn(i,"border-style").getOr(""),bordercolor:Xa(e)(Vn(i,"border-color").getOr("")),backgroundcolor:Xa(e)(Vn(i,"background-color").getOr(""))}):{};return V(V(V(V(V(V({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""}),i),c),a),(u=i["border-width"],vi(n)&&u?{border:u}:Vn(c,"border").fold((function(){return{}}),(function(n){return{border:n}})))),(r=Vn(i,"border-spacing").or(Vn(c,"cellspacing")).fold((function(){return{}}),(function(n){return{cellspacing:n}})),o=Vn(i,"border-padding").or(Vn(c,"cellpadding")).fold((function(){return{}}),(function(n){return{cellpadding:n}})),V(V({},r),o)))}(n,gi(n));!1===t?(e=o.getParent(n.selection.getStart(),"table"))?u=function(n,t,e){var r=n.dom;return V({width:r.getStyle(t,"width")||r.getAttrib(t,"width"),height:r.getStyle(t,"height")||r.getAttrib(t,"height"),cellspacing:r.getStyle(t,"border-spacing")||r.getAttrib(t,"cellspacing"),cellpadding:r.getAttrib(t,"cellpadding")||Ua(n.dom,t,"padding"),border:function(t,e){var r=qt(In.fromDom(e),"border-width");return vi(n)&&r.isSome()?r.getOr(""):t.getAttrib(e,"border")||Ua(n.dom,e,"border-width")||Ua(n.dom,e,"border")}(r,t),caption:!!r.select("caption",t)[0],class:r.getAttrib(t,"class",""),align:nl(n,t)},e?Ya(r,t):{})}(n,e,gi(n)):gi(n)&&(u.borderstyle="",u.bordercolor="",u.backgroundcolor=""):(u.cols="1",u.rows="1",gi(n)&&(u.borderstyle="",u.bordercolor="",u.backgroundcolor=""));var i=Ka(function(n){return n.getParam("table_class_list",[],"array")}(n));i.length>0&&u.class&&(u.class=u.class.replace(/\s*mce\-item\-table\s*/g,""));var c={type:"grid",columns:2,items:pl(n,i,t)},a=gi(n)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[c]},Qa("table")]}:{type:"panel",items:[c]};n.windowManager.open({title:"Table Properties",size:"normal",body:a,onSubmit:r(vl,n,e),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:u})},bl=function(n){return Ia(ki(n))},wl=function(n){return Pa(ki(n))},yl=function(t,e,o,u,i){var a=Bi(t),l=function(n){return re(n,a)},f=function(n){return function(e){t.selection.setRng(e),t.focus(),o.clear(n),Pi(n),ui(t,n.dom)}},s=function(n){return wl(t).each((function(t){l(t).each((function(e){var r=Nr(u,e,t);n(e,r).each(f(e))}))}))},d=function(){return wl(t).map((function(e){return l(e).bind((function(r){return function(n,t,e){var r=de(n);return yc(r,t).map((function(n){var t=pc(r,e,!1),o=ac(t).rows.slice(n[0].row,n[n.length-1].row+n[n.length-1].rowspan);return function(n){return E(n,(function(n){var t=br(n.element);return P(n.cells,(function(n){var e=wr(n.element);lc(e,"colspan",n.colspan,1),lc(e,"rowspan",n.rowspan,1),Ie(t,e)})),t}))}(gc(o,e))}))}(r,Nr(u,r,e),Dr(n,In.fromDom(t.getDoc()),m.none()))}))}))},p=function(){return wl(t).map((function(n){return l(n).bind((function(t){return function(n,t){var e=de(n);return yc(e,t).map((function(n){var t=n[n.length-1],r=n[0].column,o=t.column+t.colspan;return U(function(n,t,e){if(we(n)){var r=I(be(n),(function(n){return n.column>=t&&n.column<e})),o=E(r,(function(n){var r=wr(n.element);return qa(r,"span",e-t),r})),u=In.fromTag("colgroup");return Ne(u,o),[u]}return[]}(e,r,o),function(n,t,e){return E(n.all,(function(n){var r=I(n.cells,(function(n){return n.column>=t&&n.column<e})),o=E(r,(function(n){var r=wr(n.element);return qa(r,"colspan",e-t),r})),u=In.fromTag("tr");return Ne(u,o),u}))}(e,r,o))}))}(t,Nr(u,t,n))}))}))},g=function(n,e){return e().each((function(e){var r=E(e,(function(n){return wr(n)}));wl(t).each((function(e){return l(e).each((function(e){var o=Ar(In.fromDom(t.getDoc())),i=function(n,t,e,r){return{selection:Er(n),clipboard:e,generators:r}}(u,0,r,o);n(e,i).each(f(e))}))}))}))};Fn({mceTableSplitCells:function(){return s(e.unmergeCells)},mceTableMergeCells:function(){return s(e.mergeCells)},mceTableInsertRowBefore:function(){return s(e.insertRowsBefore)},mceTableInsertRowAfter:function(){return s(e.insertRowsAfter)},mceTableInsertColBefore:function(){return s(e.insertColumnsBefore)},mceTableInsertColAfter:function(){return s(e.insertColumnsAfter)},mceTableDeleteCol:function(){return s(e.deleteColumn)},mceTableDeleteRow:function(){return s(e.deleteRow)},mceTableCutCol:function(n){return p().each((function(n){i.setColumns(n),s(e.deleteColumn)}))},mceTableCutRow:function(n){return d().each((function(n){i.setRows(n),s(e.deleteRow)}))},mceTableCopyCol:function(n){return p().each((function(n){return i.setColumns(n)}))},mceTableCopyRow:function(n){return d().each((function(n){return i.setRows(n)}))},mceTablePasteColBefore:function(n){return g(e.pasteColsBefore,i.getColumns)},mceTablePasteColAfter:function(n){return g(e.pasteColsAfter,i.getColumns)},mceTablePasteRowBefore:function(n){return g(e.pasteRowsBefore,i.getRows)},mceTablePasteRowAfter:function(n){return g(e.pasteRowsAfter,i.getRows)},mceTableDelete:function(){return bl(t).each((function(n){re(n,a).filter(c(a)).each((function(n){var e=In.fromText("");if(Ee(n,e),ze(n),t.dom.isEmpty(t.getBody()))t.setContent(""),t.selection.setCursorLocation();else{var r=t.dom.createRng();r.setStart(e.dom,0),r.setEnd(e.dom,0),t.selection.setRng(r),t.nodeChanged()}}))}))},mceTableSizingMode:function(n,e){return function(n){return bl(t).each((function(e){wi(t)||bi(t)||hi(t)||re(e,a).each((function(e){"relative"!==n||pu(e)?"fixed"!==n||gu(e)?"responsive"!==n||vu(e)||Ui(e):Vi(t,e):qi(t,e),Pi(e),ui(t,e.dom)}))}))}(e)}},(function(n,e){return t.addCommand(e,n)}));var b=function(n,t){t.each((function(t){ui(n,t.dom)}))};Fn({mceTableCellType:function(n,r){var o=re(ki(t),a);e.setTableCellType(t,r),b(t,o)},mceTableRowType:function(n,r){var o=re(ki(t),a);e.setTableRowType(t,r),b(t,o)}},(function(n,e){return t.addCommand(e,n)})),t.addCommand("mceTableColType",(function(n,t){return Vn(t,"type").each((function(n){return s("th"===n?e.makeColumnsHeader:e.unmakeColumnsHeader)}))})),Fn({mceTableProps:r(hl,t,!1),mceTableRowProps:r(dl,t),mceTableCellProps:r(al,t,u)},(function(n,e){return t.addCommand(e,(function(){return n()}))})),t.addCommand("mceInsertTable",(function(n,e){h(e)&&Wn(e).length>0?ja(t,e.rows,e.columns,e.options,"Invalid values for mceInsertTable - rows and columns values are required to insert a table."):hl(t,!0)})),t.addCommand("mceTableApplyCellStyle",(function(n,e){var r=function(n){return"tablecell"+n.toLowerCase().replace("-","")};if(h(e)){var o=Ma(ki(t),u);if(0!==o.length){var i=qn(e,(function(n,e){return t.formatter.has(r(e))&&v(n)}));(function(n){for(var t in n)if(jn.call(n,t))return!1;return!0})(i)||(Fn(i,(function(n,e){P(o,(function(o){ul.normal(t,o.dom).setFormat(r(e),n)}))})),l(o[0]).each((function(n){return ui(t,n.dom,{structure:!1,style:!0})})))}}}))},xl={tablecellbackgroundcolor:{selector:"td,th",styles:{backgroundColor:"%value"},remove_similar:!0},tablecellbordercolor:{selector:"td,th",styles:{borderColor:"%value"},remove_similar:!0},tablecellborderstyle:{selector:"td,th",styles:{borderStyle:"%value"},remove_similar:!0},tablecellborderwidth:{selector:"td,th",styles:{borderWidth:"%value"},remove_similar:!0}},Cl=er([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),Sl=V(V({},Cl),{none:function(n){return void 0===n&&(n=void 0),Cl.none(n)}}),Tl=function(n,t){return re(n,t).bind((function(t){var e=te(t);return _(e,(function(t){return Nn(n,t)})).map((function(n){return{index:n,all:e}}))}))},Rl=function(n,t,e,r){return{start:n,soffset:t,finish:e,foffset:r}},Ol=er([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Dl={before:Ol.before,on:Ol.on,after:Ol.after,cata:function(n,t,e,r){return n.fold(t,e,r)},getStart:function(n){return n.fold(e,e,e)}},Al=er([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Bl={domRange:Al.domRange,relative:Al.relative,exact:Al.exact,exactFromRange:function(n){return Al.exact(n.start,n.soffset,n.finish,n.foffset)},getWin:function(n){var t=function(n){return n.match({domRange:function(n){return In.fromDom(n.startContainer)},relative:function(n,t){return Dl.getStart(n)},exact:function(n,t,e,r){return n}})}(n);return In.fromDom(it(t).dom.defaultView)},range:Rl},El=function(n,t,e){var r,o=n.document.createRange();return r=o,t.fold((function(n){r.setStartBefore(n.dom)}),(function(n,t){r.setStart(n.dom,t)}),(function(n){r.setStartAfter(n.dom)})),function(n,t){t.fold((function(t){n.setEndBefore(t.dom)}),(function(t,e){n.setEnd(t.dom,e)}),(function(t){n.setEndAfter(t.dom)}))}(o,e),o},Pl=function(n,t,e,r,o){var u=n.document.createRange();return u.setStart(t.dom,e),u.setEnd(r.dom,o),u},Il=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:n.width,height:n.height}},Ml=er([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),kl=function(n,t,e){return t(In.fromDom(e.startContainer),e.startOffset,In.fromDom(e.endContainer),e.endOffset)},Nl=function(n,e){return r=function(n,e){return e.match({domRange:function(n){return{ltr:t(n),rtl:m.none}},relative:function(t,e){return{ltr:$((function(){return El(n,t,e)})),rtl:$((function(){return m.some(El(n,e,t))}))}},exact:function(t,e,r,o){return{ltr:$((function(){return Pl(n,t,e,r,o)})),rtl:$((function(){return m.some(Pl(n,r,o,t,e))}))}}})}(n,e),(o=r.ltr()).collapsed?r.rtl().filter((function(n){return!1===n.collapsed})).map((function(n){return Ml.rtl(In.fromDom(n.endContainer),n.endOffset,In.fromDom(n.startContainer),n.startOffset)})).getOrThunk((function(){return kl(0,Ml.ltr,o)})):kl(0,Ml.ltr,o);var r,o},_l=function(n,t){return Nl(n,t).match({ltr:function(t,e,r,o){var u=n.document.createRange();return u.setStart(t.dom,e),u.setEnd(r.dom,o),u},rtl:function(t,e,r,o){var u=n.document.createRange();return u.setStart(r.dom,o),u.setEnd(t.dom,e),u}})},zl=(Ml.ltr,Ml.rtl,function(n,t,e){return t>=n.left&&t<=n.right&&e>=n.top&&e<=n.bottom}),Wl=function(n,t,e,r){return et(t)?function(n,t,e,r){var o=n.dom.createRange();o.selectNode(t.dom);var u=o.getClientRects();return q(u,(function(n){return zl(n,e,r)?m.some(n):m.none()})).map((function(o){return function(n,t,e,r,o){var u=function(e){var r=n.dom.createRange();return r.setStart(t.dom,e),r.collapse(!0),r},i=Fe(t).length,c=function(n,t,e,r,o){if(0===o)return 0;if(t===r)return o-1;for(var i=r,c=1;c<o;c++){var a=u(c).getBoundingClientRect(),l=Math.abs(t-a.left);if(e<=a.bottom){if(e<a.top||l>i)return c-1;i=l}}return 0}(0,e,r,o.right,i);return u(c)}(n,t,e,r,o)}))}(n,t,e,r):function(n,t,e,r){var o=n.dom.createRange(),u=st(t);return q(u,(function(t){return o.selectNode(t.dom),zl(o.getBoundingClientRect(),e,r)?Wl(n,t,e,r):m.none()}))}(n,t,e,r)},jl=function(n,t){return t-n.left<n.right-t},Fl=function(n,t,e){var r=n.dom.createRange();return r.selectNode(t.dom),r.collapse(e),r},Ll=function(n,t,e){var r=n.dom.createRange();r.selectNode(t.dom);var o=r.getBoundingClientRect(),u=jl(o,e);return(!0===u?pr:gr)(t).map((function(t){return Fl(n,t,u)}))},Hl=function(n,t,e){var r=t.dom.getBoundingClientRect(),o=jl(r,e);return m.some(Fl(n,t,o))},ql=document.caretPositionFromPoint?function(n,t,e){return m.from(n.dom.caretPositionFromPoint(t,e)).bind((function(t){if(null===t.offsetNode)return m.none();var e=n.dom.createRange();return e.setStart(t.offsetNode,t.offset),e.collapse(),m.some(e)}))}:document.caretRangeFromPoint?function(n,t,e){return m.from(n.dom.caretRangeFromPoint(t,e))}:function(n,t,e){return In.fromPoint(n,t,e).bind((function(r){var o=function(){return function(n,t,e){return(0===st(t).length?Hl:Ll)(n,t,e)}(n,r,t)};return 0===st(r).length?o():function(n,t,e,r){var o=n.dom.createRange();o.selectNode(t.dom);var u=o.getBoundingClientRect();return function(n,t,e,r){var o=n.dom.createRange();o.selectNode(t.dom);var u=o.getBoundingClientRect(),i=Math.max(u.left,Math.min(u.right,e)),c=Math.max(u.top,Math.min(u.bottom,r));return Wl(n,t,i,c)}(n,t,Math.max(u.left,Math.min(u.right,e)),Math.max(u.top,Math.min(u.bottom,r)))}(n,r,t,e).orThunk(o)}))},Vl=function(n,t){var e=Jn(n);return"input"===e?Dl.after(n):D(["br","img"],e)?0===t?Dl.before(n):Dl.after(n):Dl.on(n,t)},Ul=function(n,t){var e=n.fold(Dl.before,Vl,Dl.after),r=t.fold(Dl.before,Vl,Dl.after);return Bl.relative(e,r)},$l=function(n,t,e,r){var o=Vl(n,t),u=Vl(e,r);return Bl.relative(o,u)},Gl=function(n){return m.from(n.getSelection())},Kl=function(n,t){Gl(n).each((function(n){n.removeAllRanges(),n.addRange(t)}))},Xl=function(n,t,e,r,o){var u=Pl(n,t,e,r,o);Kl(n,u)},Yl=function(n,t){return Nl(n,t).match({ltr:function(t,e,r,o){Xl(n,t,e,r,o)},rtl:function(t,e,r,o){Gl(n).each((function(u){if(u.setBaseAndExtent)u.setBaseAndExtent(t.dom,e,r.dom,o);else if(u.extend)try{!function(n,t,e,r,o,u){t.collapse(e.dom,r),t.extend(o.dom,u)}(0,u,t,e,r,o)}catch(u){Xl(n,r,o,t,e)}else Xl(n,r,o,t,e)}))}})},Jl=function(n,t,e,r,o){var u=$l(t,e,r,o);Yl(n,u)},Ql=function(n,t,e){var r=Ul(t,e);Yl(n,r)},Zl=function(n){if(n.rangeCount>0){var t=n.getRangeAt(0),e=n.getRangeAt(n.rangeCount-1);return m.some(Rl(In.fromDom(t.startContainer),t.startOffset,In.fromDom(e.endContainer),e.endOffset))}return m.none()},nf=function(n){if(null===n.anchorNode||null===n.focusNode)return Zl(n);var t=In.fromDom(n.anchorNode),e=In.fromDom(n.focusNode);return function(n,t,e,r){var o=function(n,t,e,r){var o=ut(n).dom.createRange();return o.setStart(n.dom,t),o.setEnd(e.dom,r),o}(n,t,e,r),u=Nn(n,e)&&t===r;return o.collapsed&&!u}(t,n.anchorOffset,e,n.focusOffset)?m.some(Rl(t,n.anchorOffset,e,n.focusOffset)):Zl(n)},tf=function(n){return function(n){return Gl(n).filter((function(n){return n.rangeCount>0})).bind(nf)}(n).map((function(n){return Bl.exact(n.start,n.soffset,n.finish,n.foffset)}))},ef=tinymce.util.Tools.resolve("tinymce.util.VK"),rf=function(n,t,e,r){return cf(n,t,Tl(o=e,void 0).fold((function(){return Sl.none(o)}),(function(n){return n.index+1<n.all.length?Sl.middle(o,n.all[n.index+1]):Sl.last(o)})),r);var o},of=function(n,t,e,r){return cf(n,t,Tl(o=e,void 0).fold((function(){return Sl.none()}),(function(n){return n.index-1>=0?Sl.middle(o,n.all[n.index-1]):Sl.first(o)})),r);var o},uf=function(n,t){return function(n){var t=Bl.getWin(n).dom,e=function(n,e,r,o){return Pl(t,n,e,r,o)},r=function(n){return n.match({domRange:function(n){var t=In.fromDom(n.startContainer),e=In.fromDom(n.endContainer);return $l(t,n.startOffset,e,n.endOffset)},relative:Ul,exact:$l})}(n);return Nl(t,r).match({ltr:e,rtl:e})}(Bl.exact(t,0,t,0))},cf=function(n,t,e,r){return e.fold(m.none,m.none,(function(n,t){return pr(t).map((function(n){return uf(0,n)}))}),(function(e){return re(e,t).bind((function(t){var o=kr(e);return n.undoManager.transact((function(){r.insertRowsAfter(t,o)})),function(n,t){var e=St(t,"tr");return H(e).bind((function(n){return At(n,"td,th").map((function(n){return uf(0,n)}))}))}(0,t)}))}))},af=["table","li","dl"],lf=function(n,t){return{selection:n,kill:t}},ff=function(n,t,e,r){return{start:Dl.on(n,t),finish:Dl.on(e,r)}},sf=function(n,t){var e=_l(n,t);return Rl(In.fromDom(e.startContainer),e.startOffset,In.fromDom(e.endContainer),e.endOffset)},df=ff,mf=function(n,t,e,r,o){return Nn(e,r)?m.none():Ye(e,r,t).bind((function(t){var r=t.boxes.getOr([]);return r.length>0?(o(n,r,t.start,t.finish),m.some(lf(m.some(df(e,0,e,sr(e))),!0))):m.none()}))},pf=function(n,t){return{item:n,mode:t}},gf=function(n,t,e,r){return void 0===r&&(r=vf),n.property().parent(t).map((function(n){return pf(n,r)}))},vf=function(n,t,e,r){return void 0===r&&(r=hf),e.sibling(n,t).map((function(n){return pf(n,r)}))},hf=function(n,t,e,r){void 0===r&&(r=hf);var o=n.property().children(t);return e.first(o).map((function(n){return pf(n,r)}))},bf=[{current:gf,next:vf,fallback:m.none()},{current:vf,next:hf,fallback:m.some(gf)},{current:hf,next:hf,fallback:m.some(vf)}],wf=function(n,t,e,r,o){return void 0===o&&(o=bf),N(o,(function(n){return n.current===e})).bind((function(e){return e.current(n,t,r,e.next).orThunk((function(){return e.fallback.bind((function(e){return wf(n,t,e,r)}))}))}))},yf=function(n,t,e,r,o,u){return wf(n,t,r,o).bind((function(t){return u(t.item)?m.none():e(t.item)?m.some(t.item):yf(n,t.item,e,t.mode,o,u)}))},xf=function(n){return function(t){return 0===n.property().children(t).length}},Cf=function(n,t,e,r){return yf(n,t,e,vf,{sibling:function(n,t){return n.query().prevSibling(t)},first:function(n){return n.length>0?m.some(n[n.length-1]):m.none()}},r)},Sf=function(n,t,e,r){return yf(n,t,e,vf,{sibling:function(n,t){return n.query().nextSibling(t)},first:function(n){return n.length>0?m.some(n[0]):m.none()}},r)},Tf=Ve(),Rf=function(n,t){return function(n,t,e){return Cf(n,t,xf(n),e)}(Tf,n,t)},Of=function(n,t){return function(n,t,e){return Sf(n,t,xf(n),e)}(Tf,n,t)},Df=er([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),Af=function(n){return Bt(n,"tr")},Bf=V(V({},Df),{verify:function(n,t,e,r,o,u,i){return Bt(r,"td,th",i).bind((function(e){return Bt(t,"td,th",i).map((function(t){return Nn(e,t)?Nn(r,e)&&sr(e)===o?u(t):Df.none("in same cell"):Ke(Af,[e,t]).fold((function(){return function(n,t,e){var r=n.getRect(t),o=n.getRect(e);return o.right>r.left&&o.left<r.right}(n,t,e)?Df.success():u(t)}),(function(n){return u(t)}))}))})).getOr(Df.none("default"))},cata:function(n,t,e,r,o){return n.fold(t,e,r,o)}}),Ef=function(n){return"br"===Jn(n)},Pf=function(n,t,e){return t(n,e).bind((function(n){return et(n)&&0===Fe(n).trim().length?Pf(n,t,e):m.some(n)}))},If=function(n,t,e,o){return function(n,t){return dt(n,t).filter(Ef).orThunk((function(){return dt(n,t-1).filter(Ef)}))}(t,e).bind((function(t){return o.traverse(t).fold((function(){return Pf(t,o.gather,n).map(o.relative)}),(function(n){return function(n){return ct(n).bind((function(t){var e=st(t);return function(n,t){return _(n,r(Nn,t))}(e,n).map((function(r){return function(n,t,e,r){return{parent:n,children:t,element:e,index:r}}(t,e,n,r)}))}))}(n).map((function(n){return Dl.on(n.parent,n.index)}))}))}))},Mf=function(n,t){return{left:n.left,top:n.top+t,right:n.right,bottom:n.bottom+t}},kf=function(n,t){return{left:n.left,top:n.top-t,right:n.right,bottom:n.bottom-t}},Nf=function(n,t,e){return{left:n.left+t,top:n.top+e,right:n.right+t,bottom:n.bottom+e}},_f=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom}},zf=function(n,t){return m.some(n.getRect(t))},Wf=function(n,t,e){return tt(t)?zf(n,t).map(_f):et(t)?function(n,t,e){return e>=0&&e<sr(t)?n.getRangedRect(t,e,t,e+1):e>0?n.getRangedRect(t,e-1,t,e):m.none()}(n,t,e).map(_f):m.none()},jf=function(n,t){return tt(t)?zf(n,t).map(_f):et(t)?n.getRangedRect(t,0,t,sr(t)).map(_f):m.none()},Ff=er([{none:[]},{retry:["caret"]}]),Lf=function(n,t,e){return(r=t,o=Kc,Tt((function(n,t){return t(n)}),Rt,r,o,undefined)).fold(a,(function(t){return jf(n,t).exists((function(n){return function(n,t){return n.left<t.left||Math.abs(t.right-n.left)<1||n.left>t.right}(e,n)}))}));var r,o},Hf={point:function(n){return n.bottom},adjuster:function(n,t,e,r,o){var u=Mf(o,5);return Math.abs(e.bottom-r.bottom)<1||e.top>o.bottom?Ff.retry(u):e.top===o.bottom?Ff.retry(Mf(o,1)):Lf(n,t,o)?Ff.retry(Nf(u,5,0)):Ff.none()},move:Mf,gather:Of},qf=function(n,t,e,r,o){return 0===o?m.some(r):function(n,t,e){return n.elementFromPoint(t,e).filter((function(n){return"table"===Jn(n)})).isSome()}(n,r.left,t.point(r))?function(n,t,e,r,o){return qf(n,t,e,t.move(r,5),o)}(n,t,e,r,o-1):n.situsFromPoint(r.left,t.point(r)).bind((function(u){return u.start.fold(m.none,(function(u){return jf(n,u).bind((function(i){return t.adjuster(n,u,i,e,r).fold(m.none,(function(r){return qf(n,t,e,r,o-1)}))})).orThunk((function(){return m.some(r)}))}),m.none)}))},Vf=function(n,t,e){var r=n.move(e,5),o=qf(t,n,e,r,100).getOr(r);return function(n,t,e){return n.point(t)>e.getInnerHeight()?m.some(n.point(t)-e.getInnerHeight()):n.point(t)<0?m.some(-n.point(t)):m.none()}(n,o,t).fold((function(){return t.situsFromPoint(o.left,n.point(o))}),(function(e){return t.scrollBy(0,e),t.situsFromPoint(o.left,n.point(o)-e)}))},Uf={tryUp:r(Vf,{point:function(n){return n.top},adjuster:function(n,t,e,r,o){var u=kf(o,5);return Math.abs(e.top-r.top)<1||e.bottom<o.top?Ff.retry(u):e.bottom===o.top?Ff.retry(kf(o,1)):Lf(n,t,o)?Ff.retry(Nf(u,5,0)):Ff.none()},move:kf,gather:Rf}),tryDown:r(Vf,Hf),ieTryUp:function(n,t){return n.situsFromPoint(t.left,t.top-5)},ieTryDown:function(n,t){return n.situsFromPoint(t.left,t.bottom+5)},getJumpSize:t(5)},$f=function(n,t,e){return n.getSelection().bind((function(r){return function(n,t,e,r){return(Ef(t)?function(n,t,e){return e.traverse(t).orThunk((function(){return Pf(t,e.gather,n)})).map(e.relative)}(n,t,r):If(n,t,e,r)).map((function(n){return{start:n,finish:n}}))}(t,r.finish,r.foffset,e).fold((function(){return m.some(Xi(r.finish,r.foffset))}),(function(o){var u,i=n.fromSitus(o);return u=Bf.verify(n,r.finish,r.foffset,i.finish,i.foffset,e.failure,t),Bf.cata(u,(function(n){return m.none()}),(function(){return m.none()}),(function(n){return m.some(Xi(n,0))}),(function(n){return m.some(Xi(n,sr(n)))}))}))}))},Gf=function(n,t,e,r,o,u){return 0===u?m.none():Yf(n,t,e,r,o).bind((function(i){var c=n.fromSitus(i),a=Bf.verify(n,e,r,c.finish,c.foffset,o.failure,t);return Bf.cata(a,(function(){return m.none()}),(function(){return m.some(i)}),(function(i){return Nn(e,i)&&0===r?Kf(n,e,r,kf,o):Gf(n,t,i,0,o,u-1)}),(function(i){return Nn(e,i)&&r===sr(i)?Kf(n,e,r,Mf,o):Gf(n,t,i,sr(i),o,u-1)}))}))},Kf=function(n,t,e,r,o){return Wf(n,t,e).bind((function(t){return Xf(n,o,r(t,Uf.getJumpSize()))}))},Xf=function(n,t,e){var r=En().browser;return r.isChrome()||r.isSafari()||r.isFirefox()||r.isEdge()?t.otherRetry(n,e):r.isIE()?t.ieRetry(n,e):m.none()},Yf=function(n,t,e,r,o){return Wf(n,e,r).bind((function(t){return Xf(n,o,t)}))},Jf=function(n,t,e,r,o){return Bt(r,"td,th",t).bind((function(r){return Bt(r,"table",t).bind((function(u){return function(n,t){return Rt(n,(function(n){return ct(n).exists((function(n){return Nn(n,t)}))}),void 0).isSome()}(o,u)?function(n,t,e){return $f(n,t,e).bind((function(r){return Gf(n,t,r.element,r.offset,e,20).map(n.fromSitus)}))}(n,t,e).bind((function(n){return Bt(n.finish,"td,th",t).map((function(t){return{start:r,finish:t,range:n}}))})):m.none()}))}))},Qf=function(n,t,e,r,o,u){return En().browser.isIE()?m.none():u(r,t).orThunk((function(){return Jf(n,t,e,r,o).map((function(n){var t=n.range;return lf(m.some(df(t.start,t.soffset,t.finish,t.foffset)),!0)}))}))},Zf=function(n,t){return Bt(n,"tr",t).bind((function(n){return Bt(n,"table",t).bind((function(e){var r=St(e,"tr");return Nn(n,r[0])?function(n,t,e){return Cf(Tf,n,(function(n){return gr(n).isSome()}),e)}(e,0,t).map((function(n){var t=sr(n);return lf(m.some(df(n,t,n,t)),!0)})):m.none()}))}))},ns=function(n,t){return Bt(n,"tr",t).bind((function(n){return Bt(n,"table",t).bind((function(e){var r=St(e,"tr");return Nn(n,r[r.length-1])?function(n,t,e){return Sf(Tf,n,(function(n){return pr(n).isSome()}),e)}(e,0,t).map((function(n){return lf(m.some(df(n,0,n,0)),!0)})):m.none()}))}))},ts=function(n,t,e,r,o,u,i){return Jf(n,e,r,o,u).bind((function(n){return mf(t,e,n.start,n.finish,i)}))},es=function(n,t){return Bt(n,"td,th",t)};var rs={traverse:ft,gather:Of,relative:Dl.before,otherRetry:Uf.tryDown,ieRetry:Uf.ieTryDown,failure:Bf.failedDown},os={traverse:lt,gather:Rf,relative:Dl.before,otherRetry:Uf.tryUp,ieRetry:Uf.ieTryUp,failure:Bf.failedUp},us=function(n){return function(t){return t===n}},is=us(38),cs=us(40),as=function(n){return n>=37&&n<=40},ls={isBackward:us(37),isForward:us(39)},fs={isBackward:us(39),isForward:us(37)},ss=function(n){return{elementFromPoint:function(t,e){return In.fromPoint(In.fromDom(n.document),t,e)},getRect:function(n){return n.dom.getBoundingClientRect()},getRangedRect:function(t,e,r,o){var u=Bl.exact(t,e,r,o);return function(n,t){return e=_l(n,t),r=e.getClientRects(),(o=r.length>0?r[0]:e.getBoundingClientRect()).width>0||o.height>0?m.some(o).map(Il):m.none();var e,r,o}(n,u)},getSelection:function(){return tf(n).map((function(t){return sf(n,t)}))},fromSitus:function(t){var e=Bl.relative(t.start,t.finish);return sf(n,e)},situsFromPoint:function(t,e){return function(n,t,e){return function(n,t,e){var r=In.fromDom(n.document);return ql(r,t,e).map((function(n){return Rl(In.fromDom(n.startContainer),n.startOffset,In.fromDom(n.endContainer),n.endOffset)}))}(n,t,e)}(n,t,e).map((function(n){return ff(n.start,n.soffset,n.finish,n.foffset)}))},clearSelection:function(){!function(n){Gl(n).each((function(n){return n.removeAllRanges()}))}(n)},collapseSelection:function(t){void 0===t&&(t=!1),tf(n).each((function(e){return e.fold((function(n){return n.collapse(t)}),(function(e,r){var o=t?e:r;Ql(n,o,o)}),(function(e,r,o,u){var i=t?e:o,c=t?r:u;Jl(n,i,c,i,c)}))}))},setSelection:function(t){Jl(n,t.start,t.soffset,t.finish,t.foffset)},setRelativeSelection:function(t,e){Ql(n,t,e)},selectContents:function(t){!function(n,t){var e=function(n,t){var e=n.document.createRange();return function(n,t){n.selectNodeContents(t.dom)}(e,t),e}(n,t);Kl(n,e)}(n,t)},getInnerHeight:function(){return n.innerHeight},getScrollY:function(){var t,e,r,o;return(t=In.fromDom(n.document),e=void 0!==t?t.dom:document,r=e.body.scrollLeft||e.documentElement.scrollLeft,o=e.body.scrollTop||e.documentElement.scrollTop,to(r,o)).top},scrollBy:function(t,e){!function(n,t,e){var r=(void 0!==e?e.dom:document).defaultView;r&&r.scrollBy(n,t)}(t,e,In.fromDom(n.document))}}},ds=function(n,t){return{rows:n,cols:t}},ms=function(n){return!1===_u(In.fromDom(n.target),"ephox-snooker-resizer-bar")};function ps(t,e,o){var u=function(n,t,e){var r=function(t){Nt(t,n.selected),Nt(t,n.firstSelected),Nt(t,n.lastSelected)},o=function(t){Pt(t,n.selected,"1")},u=function(n){i(n),e()},i=function(t){var e=St(t,n.selectedSelector);P(e,r)};return{clearBeforeUpdate:i,clear:u,selectRange:function(e,r,i,c){u(e),P(r,o),Pt(i,n.firstSelected,"1"),Pt(c,n.lastSelected,"1"),t(r,i,c)},selectedSelector:n.selectedSelector,firstSelectedSelector:n.firstSelectedSelector,lastSelectedSelector:n.lastSelectedSelector}}(Mr,(function(e,r,u){o.targets().each((function(o){re(r).each((function(i){var c=Ti(t),a=Dr(n,In.fromDom(t.getDoc()),c),l=function(n,t,e){var r=de(n);return yc(r,t).map((function(n){var t=pc(r,e,!1);return{upOrLeftCells:function(n,t,e){var r=n.slice(0,t[t.length-1].row+1),o=gc(r,e);return W(o,(function(n){var e=n.cells.slice(0,t[t.length-1].column+1);return E(e,(function(n){return n.element}))}))}(t,n,e),downOrRightCells:function(n,t,e){var r=n.slice(t[0].row+t[0].rowspan-1,n.length),o=gc(r,e);return W(o,(function(n){var e=n.cells.slice(t[0].column+t[0].colspan-1,n.cells.length);return E(e,(function(n){return n.element}))}))}(t,n,e)}}))}(i,o,a);!function(n,t,e,r,o){n.fire("TableSelectionChange",{cells:t,start:e,finish:r,otherCells:o})}(t,e,r,u,l)}))}))}),(function(){return function(n){n.fire("TableSelectionClear")}(t)}));return t.on("init",(function(o){var i=t.getWin(),c=Oi(t),a=Bi(t),l=function(n,t,e,r){var o=function(n,t,e,r){var o,u=(o=Ni(m.none()),{clear:function(){return o.set(m.none())},set:function(n){return o.set(m.some(n))},isSet:function(){return o.get().isSome()},on:function(n){return o.get().each(n)}}),i=u.clear;return{clearstate:i,mousedown:function(n){r.clear(t),es(n.target,e).each(u.set)},mouseover:function(o){u.on((function(u){r.clearBeforeUpdate(t),es(o.target,e).each((function(o){Ye(u,o,e).each((function(e){var i=e.boxes.getOr([]);(i.length>1||1===i.length&&!Nn(u,o))&&(r.selectRange(t,i,e.start,e.finish),n.selectContents(o))}))}))}))},mouseup:function(n){i()}}}(ss(n),t,e,r);return{clearstate:o.clearstate,mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}}(i,c,a,u),f=function(n,t,e,o){var u=ss(n),i=function(){return o.clear(t),m.none()};return{keydown:function(n,c,a,l,f,s){var d=n.raw,p=d.which,g=!0===d.shiftKey;return Je(t,o.selectedSelector).fold((function(){return cs(p)&&g?r(ts,u,t,e,rs,l,c,o.selectRange):is(p)&&g?r(ts,u,t,e,os,l,c,o.selectRange):cs(p)?r(Qf,u,e,rs,l,c,ns):is(p)?r(Qf,u,e,os,l,c,Zf):m.none}),(function(n){var e=function(e){return function(){return q(e,(function(e){return function(n,t,e,r,o){return Ze(r,n,t,o.firstSelectedSelector,o.lastSelectedSelector).map((function(n){return o.clearBeforeUpdate(e),o.selectRange(e,n.boxes,n.start,n.finish),n.boxes}))}(e.rows,e.cols,t,n,o)})).fold((function(){return Qe(t,o.firstSelectedSelector,o.lastSelectedSelector).map((function(n){var e=cs(p)||s.isForward(p)?Dl.after:Dl.before;return u.setRelativeSelection(Dl.on(n.first,0),e(n.table)),o.clear(t),lf(m.none(),!0)}))}),(function(n){return m.some(lf(m.none(),!0))}))}};return cs(p)&&g?e([ds(1,0)]):is(p)&&g?e([ds(-1,0)]):s.isBackward(p)&&g?e([ds(0,-1),ds(-1,0)]):s.isForward(p)&&g?e([ds(0,1),ds(1,0)]):as(p)&&!1===g?i:m.none}))()},keyup:function(n,r,u,i,c){return Je(t,o.selectedSelector).fold((function(){var a=n.raw,l=a.which;return 0==(!0===a.shiftKey)?m.none():as(l)?function(n,t,e,r,o,u,i){return Nn(e,o)&&r===u?m.none():Bt(e,"td,th",t).bind((function(e){return Bt(o,"td,th",t).bind((function(r){return mf(n,t,e,r,i)}))}))}(t,e,r,u,i,c,o.selectRange):m.none()}),m.none)}}}(i,c,a,u),s=function(n,t,e,r){var o=ss(n);return function(n,u){r.clearBeforeUpdate(t),Ye(n,u,e).each((function(n){var e=n.boxes.getOr([]);r.selectRange(t,e,n.start,n.finish),o.selectContents(u),o.collapseSelection()}))}}(i,c,a,u);t.on("TableSelectorChange",(function(n){return s(n.start,n.finish)}));var d,p,g=function(n,e){(function(n){return!0===n.raw.shiftKey})(n)&&(e.kill&&n.kill(),e.selection.each((function(n){var e=Bl.relative(n.start,n.finish),r=_l(i,e);t.selection.setRng(r)})))},v=function(n){return 0===n.button},h=(d=Ni(In.fromDom(c)),p=Ni(0),{touchEnd:function(n){var t=In.fromDom(n.target);if("td"===Jn(t)||"th"===Jn(t)){var e=d.get(),r=p.get();Nn(e,t)&&n.timeStamp-r<300&&(n.preventDefault(),s(t,t))}d.set(t),p.set(n.timeStamp)}});t.on("dragstart",(function(n){l.clearstate()})),t.on("mousedown",(function(n){v(n)&&ms(n)&&l.mousedown(Iu(n))})),t.on("mouseover",(function(n){var t;(void 0===(t=n).buttons||ml.browser.isEdge()&&0===t.buttons||0!=(1&t.buttons))&&ms(n)&&l.mouseover(Iu(n))})),t.on("mouseup",(function(n){v(n)&&ms(n)&&l.mouseup(Iu(n))})),t.on("touchend",h.touchEnd),t.on("keyup",(function(n){var e=Iu(n);if(e.raw.shiftKey&&as(e.raw.which)){var r=t.selection.getRng(),o=In.fromDom(r.startContainer),u=In.fromDom(r.endContainer);f.keyup(e,o,r.startOffset,u,r.endOffset).each((function(n){g(e,n)}))}})),t.on("keydown",(function(n){var r=Iu(n);e().each((function(n){return n.hideBars()}));var o=t.selection.getRng(),u=In.fromDom(o.startContainer),i=In.fromDom(o.endContainer),c=Xr(ls,fs)(In.fromDom(t.selection.getStart()));f.keydown(r,u,o.startOffset,i,o.endOffset,c).each((function(n){g(r,n)})),e().each((function(n){return n.showBars()}))})),t.on("NodeChange",(function(){var e=t.selection,r=In.fromDom(e.getStart()),o=In.fromDom(e.getEnd());Ke(re,[r,o]).fold((function(){return u.clear(c)}),n)}))})),{clear:u.clear}}ar.add("table",(function(t){var e,r=(e=Mr.selectedSelector,{get:function(){return nr(Oi(t),e).fold((function(){return Ia(ki(t)).map(cr).getOrThunk(ur)}),(function(n){return ir(n)}))}}),o=function(n,t){var e=Ni(m.none()),r=Ni([]),o=function(){return Ia(ki(n)).bind((function(n){return re(n).map((function(e){return"caption"===Jn(n)?kr(n):Nr(t,e,n)}))}))},u=function(){e.set($(o)()),P(r.get(),(function(n){return n()}))},i=function(n,t){var o=function(){return e.get().fold((function(){n.setDisabled(!0)}),(function(e){n.setDisabled(t(e))}))};return o(),r.set(r.get().concat([o])),function(){r.set(I(r.get(),(function(n){return n!==o})))}};return n.on("NodeChange ExecCommand TableSelectorChange",u),{onSetupTable:function(n){return i(n,(function(n){return!1}))},onSetupCellOrRow:function(n){return i(n,(function(n){return"caption"===Jn(n.element)}))},onSetupPasteable:function(n){return function(t){return i(t,(function(t){return"caption"===Jn(t.element)||n().isNone()}))}},onSetupMergeable:function(n){return i(n,(function(n){return n.mergable.isNone()}))},onSetupUnmergeable:function(n){return i(n,(function(n){return n.unmergable.isNone()}))},resetTargets:u,targets:function(){return e.get()}}}(t,r),u=Ki(t),i=ps(t,u.lazyResize,o),c=function(t,e,r){var o=function(n){return"table"===Jn(Oi(n))},u=Ti(t),i=function(n,e,r,o){return function(i,c){Pi(i);var a=o(),l=In.fromDom(t.getDoc()),f=Dr(r,l,u),s=Li(t,i);return e(i)?n(a,i,c,f,s).bind((function(n){return P(n.newRows,(function(n){ri(t,n.dom)})),P(n.newCells,(function(n){oi(t,n.dom)})),n.cursor.map((function(n){var e=Zi(nc,n),r=t.dom.createRng();return r.setStart(e.element.dom,e.offset),r.setEnd(e.element.dom,e.offset),r}))})):m.none()}},c=i(da,(function(n){return!1===o(t)||bu(n).rows>1}),n,e),a=i(sa,(function(n){return!1===o(t)||bu(n).columns>1}),n,e),f=i(ca,l,n,e),s=i(aa,l,n,e),d=i(la,l,tc,e),p=i(fa,l,tc,e),g=i(ga,l,n,e),v=i(va,l,n,e),h=i(ba,l,n,e),b=i(wa,l,n,e),w=i(ya,l,n,e),y=i(xa,l,n,e),x=i(ha,l,n,e),C=function(n,t){return Vn(n,"type").filter((function(n){return D(t,n)}))};return{deleteRow:c,deleteColumn:a,insertRowsBefore:f,insertRowsAfter:s,insertColumnsBefore:d,insertColumnsAfter:p,mergeCells:g,unmergeCells:v,pasteColsBefore:h,pasteColsAfter:b,pasteRowsBefore:w,pasteRowsAfter:y,pasteCells:x,setTableCellType:function(n,t){return C(t,["td","th"]).each((function(t){var e=E(Ma(ki(n),r),(function(n){return n.dom}));Aa(n,e,t,null)}))},setTableRowType:function(n,t){return C(t,["header","body","footer"]).each((function(t){E(ka(ki(n),Mr.selected),(function(e){return Ba(n,e.dom,t)}))}))},makeColumnsHeader:i(ma,l,n,e),unmakeColumnsHeader:i(pa,l,n,e),getTableRowType:function(n){var t=ka(ki(n),Mr.selected);if(t.length>0){var e=E(t,(function(n){return Ra(0,n.dom)})),r=D(e,"header"),o=D(e,"footer");if(r||o){var u=D(e,"body");return!r||u||o?r||u||!o?"":"footer":"header"}return"body"}},getTableCellType:function(n){return ua(Ma(ki(n),r),(function(n){return"th"===Jn(n)})).getOr("")},getTableColType:Ca}}(t,u.lazyWire,r),a=function(){var n=Ni(m.none()),t=Ni(m.none()),e=function(n){n.set(m.none())};return{getRows:n.get,setRows:function(r){n.set(r),e(t)},clearRows:function(){return e(n)},getColumns:t.get,setColumns:function(r){t.set(r),e(n)},clearColumns:function(){return e(t)}}}();return yl(t,c,i,r,a),function(n,t,e){var r=Bi(n);Fn({mceTableRowType:function(){return t.getTableRowType(n)},mceTableCellType:function(){return t.getTableCellType(n)},mceTableColType:function(){return Pa(ki(n)).bind((function(n){return function(n){return re(n,r)}(n).map((function(r){var o=Nr(e,r,n);return t.getTableColType(r,o)}))})).getOr("")}},(function(t,e){return n.addQueryValueHandler(e,t)}))}(t,c,r),function(t,e,r,o){t.on("BeforeGetContent",(function(r){!0===r.selection&&or(e.get(),n,(function(n){r.preventDefault(),function(n){return re(n[0]).map(wr).map((function(n){return[fr(n,"[data-mce-selected]")]}))}(n).each((function(n){r.content="text"===r.format?function(n){return E(n,(function(n){return n.dom.innerText})).join("")}(n):function(n,t){return E(t,(function(t){return n.selection.serializer.serialize(t.dom,{})})).join("")}(t,n)}))}),n)})),t.on("BeforeSetContent",(function(n){!0===n.selection&&!0===n.paste&&m.from(t.dom.getParent(t.selection.getStart(),"th,td")).each((function(e){var u=In.fromDom(e);re(u).each((function(e){var i,c,a,l=I((i=n.content,(c=document.createElement("div")).innerHTML=i,st(In.fromDom(c))),(function(n){return"meta"!==Jn(n)}));if(1===l.length&&(a=l[0],"table"===Jn(a))){n.preventDefault();var f=In.fromDom(t.getDoc()),s=Ar(f),d=function(n,t,e){return{element:n,clipboard:t,generators:e}}(u,l[0],s);r.pasteCells(e,d).each((function(n){t.selection.setRng(n),t.focus(),o.clear(e)}))}}))}))}))}(t,r,c,i),function(n,t,e){var r=function(t){return function(){return n.execCommand(t)}},o=function(t){n.execCommand("mceInsertTable",!1,{rows:t.numRows,columns:t.numColumns})},u={text:"Table properties",onSetup:t.onSetupTable,onAction:r("mceTableProps")},i={text:"Delete table",icon:"table-delete-table",onSetup:t.onSetupTable,onAction:r("mceTableDelete")};n.ui.registry.addMenuItem("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",onAction:r("mceTableInsertRowBefore"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",onAction:r("mceTableInsertRowAfter"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tabledeleterow",{text:"Delete row",icon:"table-delete-row",onAction:r("mceTableDeleteRow"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablerowprops",{text:"Row properties",icon:"table-row-properties",onAction:r("mceTableRowProps"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablecutrow",{text:"Cut row",icon:"cut-row",onAction:r("mceTableCutRow"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablecopyrow",{text:"Copy row",icon:"duplicate-row",onAction:r("mceTableCopyRow"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",onAction:r("mceTablePasteRowBefore"),onSetup:t.onSetupPasteable(e.getRows)}),n.ui.registry.addMenuItem("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",onAction:r("mceTablePasteRowAfter"),onSetup:t.onSetupPasteable(e.getRows)}),n.ui.registry.addMenuItem("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",onAction:r("mceTableInsertColBefore"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",onAction:r("mceTableInsertColAfter"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",onAction:r("mceTableDeleteCol"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablecutcolumn",{text:"Cut column",icon:"cut-column",onAction:r("mceTableCutCol"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",onAction:r("mceTableCopyCol"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",onAction:r("mceTablePasteColBefore"),onSetup:t.onSetupPasteable(e.getColumns)}),n.ui.registry.addMenuItem("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",onAction:r("mceTablePasteColAfter"),onSetup:t.onSetupPasteable(e.getColumns)}),n.ui.registry.addMenuItem("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",onAction:r("mceTableCellProps"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",onAction:r("mceTableMergeCells"),onSetup:t.onSetupMergeable}),n.ui.registry.addMenuItem("tablesplitcells",{text:"Split cell",icon:"table-split-cells",onAction:r("mceTableSplitCells"),onSetup:t.onSetupUnmergeable}),!1===function(n){return n.getParam("table_grid",!0,"boolean")}(n)?n.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:r("mceInsertTable")}):n.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:o}]}}),n.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:r("mceInsertTable")}),n.ui.registry.addMenuItem("tableprops",u),n.ui.registry.addMenuItem("deletetable",i),n.ui.registry.addNestedMenuItem("row",{type:"nestedmenuitem",text:"Row",getSubmenuItems:function(){return"tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter"}}),n.ui.registry.addNestedMenuItem("column",{type:"nestedmenuitem",text:"Column",getSubmenuItems:function(){return"tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter"}}),n.ui.registry.addNestedMenuItem("cell",{type:"nestedmenuitem",text:"Cell",getSubmenuItems:function(){return"tablecellprops tablemergecells tablesplitcells"}}),n.ui.registry.addContextMenu("table",{update:function(){return t.resetTargets(),t.targets().fold((function(){return""}),(function(n){return"caption"===Jn(n.element)?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"}))}})}(t,o,a),function(n,t,e){n.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(n){return n("inserttable | cell row column | advtablesort | tableprops deletetable")}});var r=function(t){return function(){return n.execCommand(t)}};n.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:r("mceTableProps"),icon:"table",onSetup:t.onSetupTable}),n.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:r("mceTableDelete"),icon:"table-delete-table",onSetup:t.onSetupTable}),n.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:r("mceTableCellProps"),icon:"table-cell-properties",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:r("mceTableMergeCells"),icon:"table-merge-cells",onSetup:t.onSetupMergeable}),n.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:r("mceTableSplitCells"),icon:"table-split-cells",onSetup:t.onSetupUnmergeable}),n.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:r("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:r("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:r("mceTableDeleteRow"),icon:"table-delete-row",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:r("mceTableRowProps"),icon:"table-row-properties",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:r("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:r("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:r("mceTableDeleteCol"),icon:"table-delete-column",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",icon:"cut-row",onAction:r("mceTableCutRow"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",icon:"duplicate-row",onAction:r("mceTableCopyRow"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",icon:"paste-row-before",onAction:r("mceTablePasteRowBefore"),onSetup:t.onSetupPasteable(e.getRows)}),n.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",icon:"paste-row-after",onAction:r("mceTablePasteRowAfter"),onSetup:t.onSetupPasteable(e.getRows)}),n.ui.registry.addButton("tablecutcol",{tooltip:"Cut column",icon:"cut-column",onAction:r("mceTableCutCol"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablecopycol",{tooltip:"Copy column",icon:"duplicate-column",onAction:r("mceTableCopyCol"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablepastecolbefore",{tooltip:"Paste column before",icon:"paste-column-before",onAction:r("mceTablePasteColBefore"),onSetup:t.onSetupPasteable(e.getColumns)}),n.ui.registry.addButton("tablepastecolafter",{tooltip:"Paste column after",icon:"paste-column-after",onAction:r("mceTablePasteColAfter"),onSetup:t.onSetupPasteable(e.getColumns)}),n.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:r("mceInsertTable"),icon:"table"})}(t,o,a),function(n){var t=function(n){return n.getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol")}(n);t.length>0&&n.ui.registry.addContextToolbar("table",{predicate:function(t){return n.dom.is(t,"table")&&n.getBody().contains(t)},items:t,scope:"node",position:"node"})}(t),t.on("PreInit",(function(){t.serializer.addTempAttr(Mr.firstSelected),t.serializer.addTempAttr(Mr.lastSelected),function(n){n.formatter.register(xl)}(t)})),function(n){return n.getParam("table_tab_navigation",!0,"boolean")}(t)&&t.on("keydown",(function(n){!function(n,t,e){if(n.keyCode===ef.TAB){var r=Oi(t),o=function(n){var t=Jn(n);return Nn(n,r)||D(af,t)},u=t.selection.getRng();if(u.collapsed){var i=In.fromDom(u.startContainer);ne(i,o).each((function(r){n.preventDefault(),(n.shiftKey?of:rf)(t,o,r,e).each((function(n){t.selection.setRng(n)}))}))}}}(n,t,c)})),t.on("remove",(function(){u.destroy()})),function(n,t,e,r){return{insertTable:Ha(n),setClipboardRows:La(t.setRows),getClipboardRows:Fa(t.getRows),setClipboardCols:La(t.setColumns),getClipboardCols:Fa(t.getColumns),resizeHandler:e,selectionTargets:r}}(t,a,u,o)}))}();